<!DOCTYPE html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<html lang="ko" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta property="og:title" content="Amplify + AppSync Workshop" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://amplify-workshop.go-aws.com" />
    <meta property="og:image" content="https://amplify-workshop.go-aws.com/images/architecture.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.45.1" />
    <meta name="description" content="Amplify / AppSync / React Workshop">
<meta name="author" content="Gabe Hollombe">

    <link rel="shortcut icon" href="https://awskrug.github.io/amplify-photo-gallery-workshop/images/favicon.png" type="image/x-icon" />
<link rel="icon" href="https://awskrug.github.io/amplify-photo-gallery-workshop/images/favicon.png" type="image/x-icon" />
    <title>사진 버킷을 처리함수와 연결하기 :: Amplify / AppSync / React Workshop</title>

    
    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/nucleus.css?1558848519" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/hybrid.css?1558848519" rel="stylesheet">
    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/featherlight.min.css?1558848519" rel="stylesheet">
    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/perfect-scrollbar.min.css?1558848519" rel="stylesheet">
    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/auto-complete.css?1558848519" rel="stylesheet">
    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/theme.css?1558848519" rel="stylesheet">
    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/hugo-theme.css?1558848519" rel="stylesheet">
    
      <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/theme-mine.css?1558848519" rel="stylesheet">
    

    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/jquery-ui.min.css?1558848519" rel="stylesheet">
    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/jquery-ui.structure.min.css?1558848519" rel="stylesheet">
    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/jquery-ui.theme.min.css?1558848519" rel="stylesheet">
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/jquery-2.x.min.js?1558848519"></script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/jquery-ui.min.js?1558848519"></script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/tabs.js?1558848519"></script>

    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/70_generating_thumbnails/20_connecting_the_lambda_to_the_bucket.html">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/" title="Go home"><svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 30" width="60%" style="padding:20px 0px;"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg></a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fa fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="">
    <span data-search-clear=""><i class="fa fa-close"></i></span>
</div>

<script type="text/javascript" src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/lunr.min.js?1558848519"></script>
<script type="text/javascript" src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/auto-complete.js?1558848519"></script>
<script type="text/javascript">
    
        var baseurl = '\/';
    
</script>
<script type="text/javascript" src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/search.js?1558848519"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/10_prerequisites.html" title="사전준비" class="dd-item 
        
        
        
        ">
      <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/10_prerequisites.html">
          사전준비
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/10_prerequisites/1_account.html" title="AWS account 생성하기" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/10_prerequisites/1_account.html">
        AWS account 생성하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/10_prerequisites/10_workspace.html" title="Cloud9 Workspace 생성하기" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/10_prerequisites/10_workspace.html">
        Cloud9 Workspace 생성하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/10_prerequisites/20_software.html" title="설치 &amp; 설정" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/10_prerequisites/20_software.html">
        설치 &amp; 설정
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/20_getting_started.html" title="시작하기" class="dd-item 
        
        
        
        ">
      <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/20_getting_started.html">
          시작하기
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/20_getting_started/10_what_we_will_build.html" title="무엇을 빌드하나" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/20_getting_started/10_what_we_will_build.html">
        무엇을 빌드하나
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/20_getting_started/20_bootstrapping_the_app.html" title="어플리케이션 부트스트래핑" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/20_getting_started/20_bootstrapping_the_app.html">
        어플리케이션 부트스트래핑
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/30_adding_auth.html" title="인증 추가하기" class="dd-item 
        
        
        
        ">
      <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/30_adding_auth.html">
          인증 추가하기
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/30_adding_auth/10_adding_auth_back.html" title="백엔드 구성하기" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/30_adding_auth/10_adding_auth_back.html">
        백엔드 구성하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/30_adding_auth/20_adding_auth_front.html" title="프론트엔드 렌더링" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/30_adding_auth/20_adding_auth_front.html">
        프론트엔드 렌더링
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/40_graphql.html" title="GraphQL API 생성하기" class="dd-item 
        
        
        
        ">
      <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/40_graphql.html">
          GraphQL API 생성하기
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/40_graphql/10_setting_up_appsync.html" title="AppSync 세팅" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/40_graphql/10_setting_up_appsync.html">
        AppSync 세팅
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/40_graphql/20_trying_out_queries.html" title="Querie 수행하기" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/40_graphql/20_trying_out_queries.html">
        Querie 수행하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/50_working_with_albums.html" title="앨범 작업" class="dd-item 
        
        
        
        ">
      <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/50_working_with_albums.html">
          앨범 작업
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/50_working_with_albums/5_managing_albums.html" title="앨범 관리" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/50_working_with_albums/5_managing_albums.html">
        앨범 관리
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/60_managing_photos.html" title="사진 관리하기" class="dd-item 
        
        
        
        ">
      <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/60_managing_photos.html">
          사진 관리하기
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/60_managing_photos/30_adding_storage.html" title="Cloud Storage 추가하기" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/60_managing_photos/30_adding_storage.html">
        Cloud Storage 추가하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/60_managing_photos/40_upload_photos_consolidated.html" title="사진 관리하기" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/60_managing_photos/40_upload_photos_consolidated.html">
        사진 관리하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/70_generating_thumbnails.html" title="미리보기 만들기" class="dd-item 
        parent
        
        
        ">
      <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/70_generating_thumbnails.html">
          미리보기 만들기
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/70_generating_thumbnails/10_creating_a_photo_processor_lambda.html" title="사진을 처리하는 람다 함수 만들기" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/70_generating_thumbnails/10_creating_a_photo_processor_lambda.html">
        사진을 처리하는 람다 함수 만들기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/70_generating_thumbnails/20_connecting_the_lambda_to_the_bucket.html" title="사진 버킷을 처리함수와 연결하기" class="dd-item active">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/70_generating_thumbnails/20_connecting_the_lambda_to_the_bucket.html">
        사진 버킷을 처리함수와 연결하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/110_ai.html" title="AI 추가하기" class="dd-item 
        
        
        
        ">
      <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/110_ai.html">
          AI 추가하기
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/110_ai/10_rekognition.html" title="Amazon Rekognition 연동하기" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/110_ai/10_rekognition.html">
        Amazon Rekognition 연동하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/110_ai/20_prep_for_searching.html" title="사진을 검색할 수 있게 만들기" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/110_ai/20_prep_for_searching.html">
        사진을 검색할 수 있게 만들기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/110_ai/40_searching_for_labels.html" title="사진을 레이블로 검색하기" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/110_ai/40_searching_for_labels.html">
        사진을 레이블로 검색하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/120_deploying.html" title="어플리케이션 배포하기" class="dd-item 
        
        
        
        ">
      <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/120_deploying.html">
          어플리케이션 배포하기
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/120_deploying/10_deploying.html" title="S3에 어플리케이션 배포하기" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/120_deploying/10_deploying.html">
        S3에 어플리케이션 배포하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/130_wrapping_up.html" title="마무리하기" class="dd-item 
        
        
        
        ">
      <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/130_wrapping_up.html">
          마무리하기
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/130_wrapping_up/10_what_we_built.html" title="축하드립니다!" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/130_wrapping_up/10_what_we_built.html">
        축하드립니다!
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/130_wrapping_up/20_cleanup.html" title="리소스 삭제하기" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/130_wrapping_up/20_cleanup.html">
        리소스 삭제하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/140_bonus.html" title="보너스 컨텐츠" class="dd-item 
        
        
        
        ">
      <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/140_bonus.html">
          보너스 컨텐츠
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/140_bonus/10_lightbox_photos.html" title="LIGHTBOX 만들어 전체 크기의 사진들 보기" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/140_bonus/10_lightbox_photos.html">
        LIGHTBOX 만들어 전체 크기의 사진들 보기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/140_bonus/20_album_membership.html" title="다른 유저와 앨범 공유하기" class="dd-item ">
        <a href="https://awskrug.github.io/amplify-photo-gallery-workshop/140_bonus/20_album_membership.html">
        다른 유저와 앨범 공유하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3></h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://twitter.com/intent/user?screen_name=gabehollombe"><i class='fab fa-twitter fa-lg'></i> @gabehollombe</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <left>

    <h2 class="github-title">Github Repo</h2>

    <h3 class="github-title">Amplify Photo Gallery Workshop</h3>
    <a class="github-button" href="https://github.com/aws-samples/amplify-photo-gallery-workshop" data-icon="octicon-star" data-show-count="true" aria-label="Star on GitHub">Star</a>
    &nbsp;<a class="github-button" href="https://github.com/aws-samples/amplify-photo-gallery-workshop/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork on GitHub">Fork</a><br />

    <h5 class="copyright">&copy; 2018 Amazon Web Services, Inc. or its Affiliates. All rights reserved.<h5>

</left>

<script async defer src="https://buttons.github.io/buttons.js"></script> 

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fa fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            <a href='https://awskrug.github.io/amplify-photo-gallery-workshop/'>Amplify Web App Workshop</a> > <a href='https://awskrug.github.io/amplify-photo-gallery-workshop/70_generating_thumbnails.html'>미리보기 만들기</a> > 사진 버킷을 처리함수와 연결하기
          
        
          
        
          
        
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#새-사진이-s3-버킷에-업로드된-후에-함수-동작시키기">새 사진이 S3 버킷에 업로드된 후에 함수 동작시키기</a></li>
<li><a href="#s3-cloudformation-template-json-에서-변경한-내용">s3-cloudformation-template.json 에서 변경한 내용</a></li>
<li><a href="#다른-사진-업로드-시도">다른 사진 업로드 시도</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>사진 버킷을 처리함수와 연결하기</h1>
          

        




<h3 id="새-사진이-s3-버킷에-업로드된-후에-함수-동작시키기">새 사진이 S3 버킷에 업로드된 후에 함수 동작시키기</h3>

<p>사진 처리 함수를 만들었으니 이제는 함수를 실행하는 트리거를 설정해야합니다. 앨범에 업로드된 모든 사진을 처리해야 하기 때문에, Amplify로 생성한 S3 사용자 파일 버킷의 구성을 수정하여 이러한 변경 작업을 수행합니다.</p>

<ol>
<li><p><strong>photo-albums/amplify/backend/storage/photoalbumsstorage/s3-cloudformation-template.json</strong> 파일을 다음 내용으로 변경해주십시요.
<div style="height: 550px; overflow-y: scroll;">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
	<span style="color:#f92672">&#34;AWSTemplateFormatVersion&#34;</span>: <span style="color:#e6db74">&#34;2010-09-09&#34;</span>,
	<span style="color:#f92672">&#34;Description&#34;</span>: <span style="color:#e6db74">&#34;S3 resource stack creation using Amplify CLI&#34;</span>,
	<span style="color:#f92672">&#34;Parameters&#34;</span>: {
		<span style="color:#f92672">&#34;bucketName&#34;</span>: {
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;String&#34;</span>
		},
		<span style="color:#f92672">&#34;authPolicyName&#34;</span>: {
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;String&#34;</span>
		},
		<span style="color:#f92672">&#34;unauthPolicyName&#34;</span>: {
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;String&#34;</span>
		},
		<span style="color:#f92672">&#34;authRoleName&#34;</span>: {
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;String&#34;</span>
		},
		<span style="color:#f92672">&#34;unauthRoleName&#34;</span>: {
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;String&#34;</span>
		},
		<span style="color:#f92672">&#34;s3PublicPolicy&#34;</span>: {
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;String&#34;</span>
		},
		<span style="color:#f92672">&#34;s3PrivatePolicy&#34;</span>: {
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;String&#34;</span>
		},
		<span style="color:#f92672">&#34;s3ProtectedPolicy&#34;</span>: {
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;String&#34;</span>
		},
		<span style="color:#f92672">&#34;s3UploadsPolicy&#34;</span>: {
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;String&#34;</span>
		},
		<span style="color:#f92672">&#34;s3ReadPolicy&#34;</span>: {
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;String&#34;</span>
		},
		<span style="color:#f92672">&#34;s3PermissionsAuthenticatedPublic&#34;</span>: {
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;String&#34;</span>
		},
		<span style="color:#f92672">&#34;s3PermissionsAuthenticatedProtected&#34;</span>: {
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;String&#34;</span>
		},
		<span style="color:#f92672">&#34;s3PermissionsAuthenticatedPrivate&#34;</span>: {
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;String&#34;</span>
		},
		<span style="color:#f92672">&#34;s3PermissionsAuthenticatedUploads&#34;</span>: {
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;String&#34;</span>
		},
<span style="display:block;width:100%;background-color:#3c3d38">		<span style="color:#f92672">&#34;s3PermissionsGuestPublic&#34;</span>: {
</span><span style="display:block;width:100%;background-color:#3c3d38">			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;String&#34;</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">		},	
</span><span style="display:block;width:100%;background-color:#3c3d38">		<span style="color:#f92672">&#34;s3PermissionsGuestUploads&#34;</span>: {
</span><span style="display:block;width:100%;background-color:#3c3d38">			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;String&#34;</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">		},
</span><span style="display:block;width:100%;background-color:#3c3d38">		<span style="color:#f92672">&#34;AuthenticatedAllowList&#34;</span>: {
</span><span style="display:block;width:100%;background-color:#3c3d38">			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;String&#34;</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">		},
</span><span style="display:block;width:100%;background-color:#3c3d38">		<span style="color:#f92672">&#34;GuestAllowList&#34;</span>: {
</span><span style="display:block;width:100%;background-color:#3c3d38">			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;String&#34;</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">		},
</span>		<span style="color:#f92672">&#34;selectedGuestPermissions&#34;</span>: {
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;CommaDelimitedList&#34;</span>
		},
		<span style="color:#f92672">&#34;selectedAuthenticatedPermissions&#34;</span>: {
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;CommaDelimitedList&#34;</span>
		},
		<span style="color:#f92672">&#34;env&#34;</span>: {
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;String&#34;</span>
		}
	},
	<span style="color:#f92672">&#34;Conditions&#34;</span>: {
		<span style="color:#f92672">&#34;ShouldNotCreateEnvResources&#34;</span>: {
			<span style="color:#f92672">&#34;Fn::Equals&#34;</span>: [
				{
					<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;env&#34;</span>
				},
				<span style="color:#e6db74">&#34;NONE&#34;</span>
			]
		},
		<span style="color:#f92672">&#34;CreateAuthPublic&#34;</span>: {
			<span style="color:#f92672">&#34;Fn::Not&#34;</span> : [{
				<span style="color:#f92672">&#34;Fn::Equals&#34;</span> : [
					 {<span style="color:#f92672">&#34;Ref&#34;</span> : <span style="color:#e6db74">&#34;s3PermissionsAuthenticatedPublic&#34;</span>},
					 <span style="color:#e6db74">&#34;DISALLOW&#34;</span>
				]
		 }]
		},
		<span style="color:#f92672">&#34;CreateAuthProtected&#34;</span>: {
			<span style="color:#f92672">&#34;Fn::Not&#34;</span> : [{
				<span style="color:#f92672">&#34;Fn::Equals&#34;</span> : [
					 {<span style="color:#f92672">&#34;Ref&#34;</span> : <span style="color:#e6db74">&#34;s3PermissionsAuthenticatedProtected&#34;</span>},
					 <span style="color:#e6db74">&#34;DISALLOW&#34;</span>
				]
		 }]
		},
		<span style="color:#f92672">&#34;CreateAuthPrivate&#34;</span>: {
			<span style="color:#f92672">&#34;Fn::Not&#34;</span> : [{
				<span style="color:#f92672">&#34;Fn::Equals&#34;</span> : [
					 {<span style="color:#f92672">&#34;Ref&#34;</span> : <span style="color:#e6db74">&#34;s3PermissionsAuthenticatedPrivate&#34;</span>},
					 <span style="color:#e6db74">&#34;DISALLOW&#34;</span>
				]
		 }]
		},
		<span style="color:#f92672">&#34;CreateAuthUploads&#34;</span>: {
			<span style="color:#f92672">&#34;Fn::Not&#34;</span> : [{
				<span style="color:#f92672">&#34;Fn::Equals&#34;</span> : [
					 {<span style="color:#f92672">&#34;Ref&#34;</span> : <span style="color:#e6db74">&#34;s3PermissionsAuthenticatedUploads&#34;</span>},
					 <span style="color:#e6db74">&#34;DISALLOW&#34;</span>
				]
		 }]
		},
		<span style="color:#f92672">&#34;CreateGuestPublic&#34;</span>: {
			<span style="color:#f92672">&#34;Fn::Not&#34;</span> : [{
				<span style="color:#f92672">&#34;Fn::Equals&#34;</span> : [
					 {<span style="color:#f92672">&#34;Ref&#34;</span> : <span style="color:#e6db74">&#34;s3PermissionsGuestPublic&#34;</span>},
					 <span style="color:#e6db74">&#34;DISALLOW&#34;</span>
				]
		 }]
		},
		<span style="color:#f92672">&#34;CreateGuestUploads&#34;</span>: {
			<span style="color:#f92672">&#34;Fn::Not&#34;</span> : [{
				<span style="color:#f92672">&#34;Fn::Equals&#34;</span> : [
					 {<span style="color:#f92672">&#34;Ref&#34;</span> : <span style="color:#e6db74">&#34;s3PermissionsGuestUploads&#34;</span>},
					 <span style="color:#e6db74">&#34;DISALLOW&#34;</span>
				]
		 }]
		},
		<span style="color:#f92672">&#34;AuthReadAndList&#34;</span>: {
			<span style="color:#f92672">&#34;Fn::Not&#34;</span> : [{
				<span style="color:#f92672">&#34;Fn::Equals&#34;</span> : [
					 {<span style="color:#f92672">&#34;Ref&#34;</span> : <span style="color:#e6db74">&#34;AuthenticatedAllowList&#34;</span>},
					 <span style="color:#e6db74">&#34;DISALLOW&#34;</span>
				]
		 }]
		},
		<span style="color:#f92672">&#34;GuestReadAndList&#34;</span>: {
			<span style="color:#f92672">&#34;Fn::Not&#34;</span> : [{
				<span style="color:#f92672">&#34;Fn::Equals&#34;</span> : [
					 {<span style="color:#f92672">&#34;Ref&#34;</span> : <span style="color:#e6db74">&#34;GuestAllowList&#34;</span>},
					 <span style="color:#e6db74">&#34;DISALLOW&#34;</span>
				]
		 }]
		}
	},
	<span style="color:#f92672">&#34;Resources&#34;</span>: {
<span style="display:block;width:100%;background-color:#3c3d38">		<span style="color:#f92672">&#34;InvokePhotoProcessorLambda&#34;</span>: {
</span><span style="display:block;width:100%;background-color:#3c3d38">			<span style="color:#f92672">&#34;Type&#34;</span> : <span style="color:#e6db74">&#34;AWS::Lambda::Permission&#34;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">			<span style="color:#f92672">&#34;Properties&#34;</span> : {
</span><span style="display:block;width:100%;background-color:#3c3d38">				<span style="color:#f92672">&#34;Action&#34;</span> : <span style="color:#e6db74">&#34;lambda:InvokeFunction&#34;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">				<span style="color:#f92672">&#34;FunctionName&#34;</span> : <span style="color:#e6db74">&#34;workshopphotoprocessor&#34;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">				<span style="color:#f92672">&#34;Principal&#34;</span> : <span style="color:#e6db74">&#34;s3.amazonaws.com&#34;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">				<span style="color:#f92672">&#34;SourceAccount&#34;</span> :  { <span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;AWS::AccountId&#34;</span> },
</span><span style="display:block;width:100%;background-color:#3c3d38">				<span style="color:#f92672">&#34;SourceArn&#34;</span>: {
</span><span style="display:block;width:100%;background-color:#3c3d38">					<span style="color:#f92672">&#34;Fn::Join&#34;</span>: [
</span><span style="display:block;width:100%;background-color:#3c3d38">						<span style="color:#e6db74">&#34;&#34;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">						[
</span><span style="display:block;width:100%;background-color:#3c3d38">							<span style="color:#e6db74">&#34;arn:aws:s3:::&#34;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">							{
</span><span style="display:block;width:100%;background-color:#3c3d38">								<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;bucketName&#34;</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">							},
</span><span style="display:block;width:100%;background-color:#3c3d38">							<span style="color:#e6db74">&#34;-&#34;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">							{
</span><span style="display:block;width:100%;background-color:#3c3d38">								<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;env&#34;</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">							}
</span><span style="display:block;width:100%;background-color:#3c3d38">						]
</span><span style="display:block;width:100%;background-color:#3c3d38">					]
</span><span style="display:block;width:100%;background-color:#3c3d38">				}
</span><span style="display:block;width:100%;background-color:#3c3d38">			}
</span><span style="display:block;width:100%;background-color:#3c3d38">		},
</span>		<span style="color:#f92672">&#34;S3Bucket&#34;</span>: {
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;AWS::S3::Bucket&#34;</span>,
			<span style="color:#f92672">&#34;DeletionPolicy&#34;</span> : <span style="color:#e6db74">&#34;Retain&#34;</span>,
			<span style="color:#f92672">&#34;Properties&#34;</span>: {
				<span style="color:#f92672">&#34;BucketName&#34;</span>: {
                    <span style="color:#f92672">&#34;Fn::If&#34;</span>: [
                        <span style="color:#e6db74">&#34;ShouldNotCreateEnvResources&#34;</span>,
                        {
                            <span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;bucketName&#34;</span>
                        },
                        {
                            <span style="color:#f92672">&#34;Fn::Join&#34;</span>: [
                                <span style="color:#e6db74">&#34;&#34;</span>,
                                [
                                    {
                                        <span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;bucketName&#34;</span>
                                    },
                                    <span style="color:#e6db74">&#34;-&#34;</span>,
                                    {
                                        <span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;env&#34;</span>
                                    }
                                ]
                            ]
                        }
                    ]
                },
				<span style="color:#f92672">&#34;CorsConfiguration&#34;</span>: {
					<span style="color:#f92672">&#34;CorsRules&#34;</span>: [
						{
							<span style="color:#f92672">&#34;AllowedHeaders&#34;</span>: [
								<span style="color:#e6db74">&#34;*&#34;</span>
							],
							<span style="color:#f92672">&#34;AllowedMethods&#34;</span>: [
								<span style="color:#e6db74">&#34;GET&#34;</span>,
								<span style="color:#e6db74">&#34;HEAD&#34;</span>,
								<span style="color:#e6db74">&#34;PUT&#34;</span>,
								<span style="color:#e6db74">&#34;POST&#34;</span>,
								<span style="color:#e6db74">&#34;DELETE&#34;</span>
							],
							<span style="color:#f92672">&#34;AllowedOrigins&#34;</span>: [
								<span style="color:#e6db74">&#34;*&#34;</span>
							],
							<span style="color:#f92672">&#34;ExposedHeaders&#34;</span>: [
								<span style="color:#e6db74">&#34;x-amz-server-side-encryption&#34;</span>,
								<span style="color:#e6db74">&#34;x-amz-request-id&#34;</span>,
								<span style="color:#e6db74">&#34;x-amz-id-2&#34;</span>,
								<span style="color:#e6db74">&#34;ETag&#34;</span>
							],
							<span style="color:#f92672">&#34;Id&#34;</span>: <span style="color:#e6db74">&#34;S3CORSRuleId1&#34;</span>,
							<span style="color:#f92672">&#34;MaxAge&#34;</span>: <span style="color:#e6db74">&#34;3000&#34;</span>
						}
					]
				},
<span style="display:block;width:100%;background-color:#3c3d38">				<span style="color:#f92672">&#34;NotificationConfiguration&#34;</span>: {
</span><span style="display:block;width:100%;background-color:#3c3d38">					<span style="color:#f92672">&#34;LambdaConfigurations&#34;</span>: [
</span><span style="display:block;width:100%;background-color:#3c3d38">						{
</span><span style="display:block;width:100%;background-color:#3c3d38">							<span style="color:#f92672">&#34;Function&#34;</span>: {
</span><span style="display:block;width:100%;background-color:#3c3d38">								<span style="color:#f92672">&#34;Fn::Join&#34;</span>: [<span style="color:#e6db74">&#34;:&#34;</span>, [
</span><span style="display:block;width:100%;background-color:#3c3d38">									<span style="color:#e6db74">&#34;arn:aws:lambda&#34;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">									{ <span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;AWS::Region&#34;</span> },
</span><span style="display:block;width:100%;background-color:#3c3d38">									{ <span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;AWS::AccountId&#34;</span> },
</span><span style="display:block;width:100%;background-color:#3c3d38">									<span style="color:#e6db74">&#34;function&#34;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">									<span style="color:#e6db74">&#34;workshopphotoprocessor&#34;</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">									]
</span><span style="display:block;width:100%;background-color:#3c3d38">								]
</span><span style="display:block;width:100%;background-color:#3c3d38">							},
</span><span style="display:block;width:100%;background-color:#3c3d38">							<span style="color:#f92672">&#34;Event&#34;</span>: <span style="color:#e6db74">&#34;s3:ObjectCreated:Put&#34;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">							<span style="color:#f92672">&#34;Filter&#34;</span>: {
</span><span style="display:block;width:100%;background-color:#3c3d38">								<span style="color:#f92672">&#34;S3Key&#34;</span>: {
</span><span style="display:block;width:100%;background-color:#3c3d38">									<span style="color:#f92672">&#34;Rules&#34;</span>: [ 
</span><span style="display:block;width:100%;background-color:#3c3d38">										{ <span style="color:#f92672">&#34;Name&#34;</span>: <span style="color:#e6db74">&#34;prefix&#34;</span>, <span style="color:#f92672">&#34;Value&#34;</span>: <span style="color:#e6db74">&#34;uploads/&#34;</span> }
</span><span style="display:block;width:100%;background-color:#3c3d38">									]
</span><span style="display:block;width:100%;background-color:#3c3d38">								}
</span><span style="display:block;width:100%;background-color:#3c3d38">							}
</span><span style="display:block;width:100%;background-color:#3c3d38">						}
</span><span style="display:block;width:100%;background-color:#3c3d38">					]
</span><span style="display:block;width:100%;background-color:#3c3d38">				}
</span>			}
		},
<span style="display:block;width:100%;background-color:#3c3d38">		<span style="color:#f92672">&#34;DenyListS3BucketsAuth&#34;</span>: {
</span><span style="display:block;width:100%;background-color:#3c3d38">			<span style="color:#f92672">&#34;DependsOn&#34;</span>: [ <span style="color:#e6db74">&#34;S3Bucket&#34;</span> ],
</span><span style="display:block;width:100%;background-color:#3c3d38">			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;AWS::IAM::Policy&#34;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">			<span style="color:#f92672">&#34;Properties&#34;</span>: {
</span><span style="display:block;width:100%;background-color:#3c3d38">				<span style="color:#f92672">&#34;PolicyName&#34;</span>: <span style="color:#e6db74">&#34;DenyListS3Buckets&#34;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">				<span style="color:#f92672">&#34;Roles&#34;</span>: [ { <span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;authRoleName&#34;</span> } ],
</span><span style="display:block;width:100%;background-color:#3c3d38">				<span style="color:#f92672">&#34;PolicyDocument&#34;</span>: {
</span><span style="display:block;width:100%;background-color:#3c3d38">					<span style="color:#f92672">&#34;Version&#34;</span>: <span style="color:#e6db74">&#34;2012-10-17&#34;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">					<span style="color:#f92672">&#34;Statement&#34;</span>: [
</span><span style="display:block;width:100%;background-color:#3c3d38">						{
</span><span style="display:block;width:100%;background-color:#3c3d38">							<span style="color:#f92672">&#34;Effect&#34;</span>: <span style="color:#e6db74">&#34;Deny&#34;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">							<span style="color:#f92672">&#34;Action&#34;</span>: [ <span style="color:#e6db74">&#34;s3:ListBucket&#34;</span> ],
</span><span style="display:block;width:100%;background-color:#3c3d38">							<span style="color:#f92672">&#34;Resource&#34;</span>: [<span style="color:#e6db74">&#34;*&#34;</span>]
</span><span style="display:block;width:100%;background-color:#3c3d38">						}
</span><span style="display:block;width:100%;background-color:#3c3d38">					]
</span><span style="display:block;width:100%;background-color:#3c3d38">				}
</span><span style="display:block;width:100%;background-color:#3c3d38">			}
</span><span style="display:block;width:100%;background-color:#3c3d38">		},
</span><span style="display:block;width:100%;background-color:#3c3d38">		<span style="color:#f92672">&#34;DenyListS3BucketsGuest&#34;</span>: {
</span><span style="display:block;width:100%;background-color:#3c3d38">			<span style="color:#f92672">&#34;DependsOn&#34;</span>: [ <span style="color:#e6db74">&#34;S3Bucket&#34;</span> ],
</span><span style="display:block;width:100%;background-color:#3c3d38">			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;AWS::IAM::Policy&#34;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">			<span style="color:#f92672">&#34;Properties&#34;</span>: {
</span><span style="display:block;width:100%;background-color:#3c3d38">				<span style="color:#f92672">&#34;PolicyName&#34;</span>: <span style="color:#e6db74">&#34;DenyListS3BucketsGuest&#34;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">				<span style="color:#f92672">&#34;Roles&#34;</span>: [ { <span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;unauthRoleName&#34;</span> } ],
</span><span style="display:block;width:100%;background-color:#3c3d38">				<span style="color:#f92672">&#34;PolicyDocument&#34;</span>: {
</span><span style="display:block;width:100%;background-color:#3c3d38">					<span style="color:#f92672">&#34;Version&#34;</span>: <span style="color:#e6db74">&#34;2012-10-17&#34;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">					<span style="color:#f92672">&#34;Statement&#34;</span>: [
</span><span style="display:block;width:100%;background-color:#3c3d38">						{
</span><span style="display:block;width:100%;background-color:#3c3d38">							<span style="color:#f92672">&#34;Effect&#34;</span>: <span style="color:#e6db74">&#34;Deny&#34;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">							<span style="color:#f92672">&#34;Action&#34;</span>: [ <span style="color:#e6db74">&#34;s3:ListBucket&#34;</span> ],
</span><span style="display:block;width:100%;background-color:#3c3d38">							<span style="color:#f92672">&#34;Resource&#34;</span>: [<span style="color:#e6db74">&#34;*&#34;</span>]
</span><span style="display:block;width:100%;background-color:#3c3d38">						}
</span><span style="display:block;width:100%;background-color:#3c3d38">					]
</span><span style="display:block;width:100%;background-color:#3c3d38">				}
</span><span style="display:block;width:100%;background-color:#3c3d38">			}
</span><span style="display:block;width:100%;background-color:#3c3d38">		},		
</span>		<span style="color:#f92672">&#34;S3AuthPublicPolicy&#34;</span>: {
			<span style="color:#f92672">&#34;DependsOn&#34;</span>: [
				<span style="color:#e6db74">&#34;S3Bucket&#34;</span>
			],
			<span style="color:#f92672">&#34;Condition&#34;</span>: <span style="color:#e6db74">&#34;CreateAuthPublic&#34;</span>,
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;AWS::IAM::Policy&#34;</span>,
			<span style="color:#f92672">&#34;Properties&#34;</span>: {
				<span style="color:#f92672">&#34;PolicyName&#34;</span>: {
					<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;s3PublicPolicy&#34;</span>
				},
				<span style="color:#f92672">&#34;Roles&#34;</span>: [
					{
						<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;authRoleName&#34;</span>
					}
				],
				<span style="color:#f92672">&#34;PolicyDocument&#34;</span>: {
					<span style="color:#f92672">&#34;Version&#34;</span>: <span style="color:#e6db74">&#34;2012-10-17&#34;</span>,
					<span style="color:#f92672">&#34;Statement&#34;</span>: [
						{
							<span style="color:#f92672">&#34;Effect&#34;</span>: <span style="color:#e6db74">&#34;Allow&#34;</span>,
							<span style="color:#f92672">&#34;Action&#34;</span>: {
								<span style="color:#f92672">&#34;Fn::Split&#34;</span> : [ <span style="color:#e6db74">&#34;,&#34;</span> , {
									<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;s3PermissionsAuthenticatedPublic&#34;</span>
								} ] 
							},
							<span style="color:#f92672">&#34;Resource&#34;</span>: [
								{
									<span style="color:#f92672">&#34;Fn::Join&#34;</span>: [
										<span style="color:#e6db74">&#34;&#34;</span>,
										[
											<span style="color:#e6db74">&#34;arn:aws:s3:::&#34;</span>,
											{
												<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;S3Bucket&#34;</span>
											},
											<span style="color:#e6db74">&#34;/public/*&#34;</span>
										]
									]
								}
							]
						}
					]
				}
			}
		},
		<span style="color:#f92672">&#34;S3AuthProtectedPolicy&#34;</span>: {
			<span style="color:#f92672">&#34;DependsOn&#34;</span>: [
				<span style="color:#e6db74">&#34;S3Bucket&#34;</span>
			],
			<span style="color:#f92672">&#34;Condition&#34;</span>: <span style="color:#e6db74">&#34;CreateAuthProtected&#34;</span>,
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;AWS::IAM::Policy&#34;</span>,
			<span style="color:#f92672">&#34;Properties&#34;</span>: {
				<span style="color:#f92672">&#34;PolicyName&#34;</span>: {
					<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;s3ProtectedPolicy&#34;</span>
				},
				<span style="color:#f92672">&#34;Roles&#34;</span>: [
					{
						<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;authRoleName&#34;</span>
					}
				],
				<span style="color:#f92672">&#34;PolicyDocument&#34;</span>: {
					<span style="color:#f92672">&#34;Version&#34;</span>: <span style="color:#e6db74">&#34;2012-10-17&#34;</span>,
					<span style="color:#f92672">&#34;Statement&#34;</span>: [
						{
							<span style="color:#f92672">&#34;Effect&#34;</span>: <span style="color:#e6db74">&#34;Allow&#34;</span>,
							<span style="color:#f92672">&#34;Action&#34;</span>: {
								<span style="color:#f92672">&#34;Fn::Split&#34;</span> : [ <span style="color:#e6db74">&#34;,&#34;</span> , {
									<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;s3PermissionsAuthenticatedProtected&#34;</span>
								} ] 
							},
							<span style="color:#f92672">&#34;Resource&#34;</span>: [
								{
									<span style="color:#f92672">&#34;Fn::Join&#34;</span>: [
										<span style="color:#e6db74">&#34;&#34;</span>,
										[
											<span style="color:#e6db74">&#34;arn:aws:s3:::&#34;</span>,
											{
												<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;S3Bucket&#34;</span>
											},
											<span style="color:#e6db74">&#34;/protected/${cognito-identity.amazonaws.com:sub}/*&#34;</span>
										]
									]
								}
							]
						}
					]
				}
			}
		},
		<span style="color:#f92672">&#34;S3AuthPrivatePolicy&#34;</span>: {
			<span style="color:#f92672">&#34;DependsOn&#34;</span>: [
				<span style="color:#e6db74">&#34;S3Bucket&#34;</span>
			],
			<span style="color:#f92672">&#34;Condition&#34;</span>: <span style="color:#e6db74">&#34;CreateAuthPrivate&#34;</span>,
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;AWS::IAM::Policy&#34;</span>,
			<span style="color:#f92672">&#34;Properties&#34;</span>: {
				<span style="color:#f92672">&#34;PolicyName&#34;</span>: {
					<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;s3PrivatePolicy&#34;</span>
				},
				<span style="color:#f92672">&#34;Roles&#34;</span>: [
					{
						<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;authRoleName&#34;</span>
					}
				],
				<span style="color:#f92672">&#34;PolicyDocument&#34;</span>: {
					<span style="color:#f92672">&#34;Version&#34;</span>: <span style="color:#e6db74">&#34;2012-10-17&#34;</span>,
					<span style="color:#f92672">&#34;Statement&#34;</span>: [
						{
							<span style="color:#f92672">&#34;Effect&#34;</span>: <span style="color:#e6db74">&#34;Allow&#34;</span>,
							<span style="color:#f92672">&#34;Action&#34;</span>: {
								<span style="color:#f92672">&#34;Fn::Split&#34;</span> : [ <span style="color:#e6db74">&#34;,&#34;</span> , {
									<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;s3PermissionsAuthenticatedPrivate&#34;</span>
								} ] 
							},
							<span style="color:#f92672">&#34;Resource&#34;</span>: [
								{
									<span style="color:#f92672">&#34;Fn::Join&#34;</span>: [
										<span style="color:#e6db74">&#34;&#34;</span>,
										[
											<span style="color:#e6db74">&#34;arn:aws:s3:::&#34;</span>,
											{
												<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;S3Bucket&#34;</span>
											},
											<span style="color:#e6db74">&#34;/private/${cognito-identity.amazonaws.com:sub}/*&#34;</span>
										]
									]
								}
							]
						}
					]
				}
			}
		},
		<span style="color:#f92672">&#34;S3AuthUploadPolicy&#34;</span>: {
			<span style="color:#f92672">&#34;DependsOn&#34;</span>: [
				<span style="color:#e6db74">&#34;S3Bucket&#34;</span>
			],
			<span style="color:#f92672">&#34;Condition&#34;</span>: <span style="color:#e6db74">&#34;CreateAuthUploads&#34;</span>,
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;AWS::IAM::Policy&#34;</span>,
			<span style="color:#f92672">&#34;Properties&#34;</span>: {
				<span style="color:#f92672">&#34;PolicyName&#34;</span>: {
					<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;s3UploadsPolicy&#34;</span>
				},
				<span style="color:#f92672">&#34;Roles&#34;</span>: [
					{
						<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;authRoleName&#34;</span>
					}
				],
				<span style="color:#f92672">&#34;PolicyDocument&#34;</span>: {
					<span style="color:#f92672">&#34;Version&#34;</span>: <span style="color:#e6db74">&#34;2012-10-17&#34;</span>,
					<span style="color:#f92672">&#34;Statement&#34;</span>: [
						{
							<span style="color:#f92672">&#34;Effect&#34;</span>: <span style="color:#e6db74">&#34;Allow&#34;</span>,
							<span style="color:#f92672">&#34;Action&#34;</span>: {
								<span style="color:#f92672">&#34;Fn::Split&#34;</span> : [ <span style="color:#e6db74">&#34;,&#34;</span> , {
									<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;s3PermissionsAuthenticatedUploads&#34;</span>
								} ] 
							},
							<span style="color:#f92672">&#34;Resource&#34;</span>: [
								{
									<span style="color:#f92672">&#34;Fn::Join&#34;</span>: [
										<span style="color:#e6db74">&#34;&#34;</span>,
										[
											<span style="color:#e6db74">&#34;arn:aws:s3:::&#34;</span>,
											{
												<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;S3Bucket&#34;</span>
											},
											<span style="color:#e6db74">&#34;/uploads/*&#34;</span>
										]
									]
								}
							]
						}
					]
				}
			}
		},
		<span style="color:#f92672">&#34;S3AuthReadPolicy&#34;</span>: {
			<span style="color:#f92672">&#34;DependsOn&#34;</span>: [
				<span style="color:#e6db74">&#34;S3Bucket&#34;</span>
			],
			<span style="color:#f92672">&#34;Condition&#34;</span>: <span style="color:#e6db74">&#34;AuthReadAndList&#34;</span>,
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;AWS::IAM::Policy&#34;</span>,
			<span style="color:#f92672">&#34;Properties&#34;</span>: {
				<span style="color:#f92672">&#34;PolicyName&#34;</span>: {
					<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;s3ReadPolicy&#34;</span>
				},
				<span style="color:#f92672">&#34;Roles&#34;</span>: [
					{
						<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;authRoleName&#34;</span>
					}
				],
				<span style="color:#f92672">&#34;PolicyDocument&#34;</span>: {
					<span style="color:#f92672">&#34;Version&#34;</span>: <span style="color:#e6db74">&#34;2012-10-17&#34;</span>,
					<span style="color:#f92672">&#34;Statement&#34;</span>: [
						{
							<span style="color:#f92672">&#34;Effect&#34;</span>: <span style="color:#e6db74">&#34;Allow&#34;</span>,
							<span style="color:#f92672">&#34;Action&#34;</span>: [
								<span style="color:#e6db74">&#34;s3:GetObject&#34;</span>
							],
							<span style="color:#f92672">&#34;Resource&#34;</span>: [
								{
									<span style="color:#f92672">&#34;Fn::Join&#34;</span>: [
										<span style="color:#e6db74">&#34;&#34;</span>,
										[
											<span style="color:#e6db74">&#34;arn:aws:s3:::&#34;</span>,
											{
												<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;S3Bucket&#34;</span>
											},
											<span style="color:#e6db74">&#34;/protected/*&#34;</span>
										]
									]
								}
							]
						},
						{
							<span style="color:#f92672">&#34;Effect&#34;</span>: <span style="color:#e6db74">&#34;Allow&#34;</span>,
							<span style="color:#f92672">&#34;Action&#34;</span>: [
								<span style="color:#e6db74">&#34;s3:ListBucket&#34;</span>
							],
							<span style="color:#f92672">&#34;Resource&#34;</span>: [
								{
									<span style="color:#f92672">&#34;Fn::Join&#34;</span>: [
										<span style="color:#e6db74">&#34;&#34;</span>,
										[
											<span style="color:#e6db74">&#34;arn:aws:s3:::&#34;</span>,
											{
												<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;S3Bucket&#34;</span>
											}
										]
									]
								}
							],
							<span style="color:#f92672">&#34;Condition&#34;</span>: {
								<span style="color:#f92672">&#34;StringLike&#34;</span>: {
									<span style="color:#f92672">&#34;s3:prefix&#34;</span>: [
										<span style="color:#e6db74">&#34;public/&#34;</span>,
										<span style="color:#e6db74">&#34;public/*&#34;</span>,
										<span style="color:#e6db74">&#34;protected/&#34;</span>,
										<span style="color:#e6db74">&#34;protected/*&#34;</span>,
										<span style="color:#e6db74">&#34;private/${cognito-identity.amazonaws.com:sub}/&#34;</span>,
										<span style="color:#e6db74">&#34;private/${cognito-identity.amazonaws.com:sub}/*&#34;</span>
									]
								}
							}
						}
					]
				}
			}
		},
		<span style="color:#f92672">&#34;S3GuestPublicPolicy&#34;</span>: {
			<span style="color:#f92672">&#34;DependsOn&#34;</span>: [
				<span style="color:#e6db74">&#34;S3Bucket&#34;</span>
			],
			<span style="color:#f92672">&#34;Condition&#34;</span>: <span style="color:#e6db74">&#34;CreateGuestPublic&#34;</span>,
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;AWS::IAM::Policy&#34;</span>,
			<span style="color:#f92672">&#34;Properties&#34;</span>: {
				<span style="color:#f92672">&#34;PolicyName&#34;</span>: {
					<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;s3PublicPolicy&#34;</span>
				},
				<span style="color:#f92672">&#34;Roles&#34;</span>: [
					{
						<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;unauthRoleName&#34;</span>
					}
				],
				<span style="color:#f92672">&#34;PolicyDocument&#34;</span>: {
					<span style="color:#f92672">&#34;Version&#34;</span>: <span style="color:#e6db74">&#34;2012-10-17&#34;</span>,
					<span style="color:#f92672">&#34;Statement&#34;</span>: [
						{
							<span style="color:#f92672">&#34;Effect&#34;</span>: <span style="color:#e6db74">&#34;Allow&#34;</span>,
							<span style="color:#f92672">&#34;Action&#34;</span>: {
								<span style="color:#f92672">&#34;Fn::Split&#34;</span> : [ <span style="color:#e6db74">&#34;,&#34;</span> , {
									<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;s3PermissionsGuestPublic&#34;</span>
								} ] 
							},
							<span style="color:#f92672">&#34;Resource&#34;</span>: [
								{
									<span style="color:#f92672">&#34;Fn::Join&#34;</span>: [
										<span style="color:#e6db74">&#34;&#34;</span>,
										[
											<span style="color:#e6db74">&#34;arn:aws:s3:::&#34;</span>,
											{
												<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;S3Bucket&#34;</span>
											},
											<span style="color:#e6db74">&#34;/public/*&#34;</span>
										]
									]
								}
							]
						}
					]
				}
			}
		},
		<span style="color:#f92672">&#34;S3GuestUploadPolicy&#34;</span>: {
			<span style="color:#f92672">&#34;DependsOn&#34;</span>: [
				<span style="color:#e6db74">&#34;S3Bucket&#34;</span>
			],
			<span style="color:#f92672">&#34;Condition&#34;</span>: <span style="color:#e6db74">&#34;CreateGuestUploads&#34;</span>,
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;AWS::IAM::Policy&#34;</span>,
			<span style="color:#f92672">&#34;Properties&#34;</span>: {
				<span style="color:#f92672">&#34;PolicyName&#34;</span>: {
					<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;s3UploadsPolicy&#34;</span>
				},
				<span style="color:#f92672">&#34;Roles&#34;</span>: [
					{
						<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;unauthRoleName&#34;</span>
					}
				],
				<span style="color:#f92672">&#34;PolicyDocument&#34;</span>: {
					<span style="color:#f92672">&#34;Version&#34;</span>: <span style="color:#e6db74">&#34;2012-10-17&#34;</span>,
					<span style="color:#f92672">&#34;Statement&#34;</span>: [
						{
							<span style="color:#f92672">&#34;Effect&#34;</span>: <span style="color:#e6db74">&#34;Allow&#34;</span>,
							<span style="color:#f92672">&#34;Action&#34;</span>: {
								<span style="color:#f92672">&#34;Fn::Split&#34;</span> : [ <span style="color:#e6db74">&#34;,&#34;</span> , {
									<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;s3PermissionsGuestUploads&#34;</span>
								} ] 
							},
							<span style="color:#f92672">&#34;Resource&#34;</span>: [
								{
									<span style="color:#f92672">&#34;Fn::Join&#34;</span>: [
										<span style="color:#e6db74">&#34;&#34;</span>,
										[
											<span style="color:#e6db74">&#34;arn:aws:s3:::&#34;</span>,
											{
												<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;S3Bucket&#34;</span>
											},
											<span style="color:#e6db74">&#34;/uploads/*&#34;</span>
										]
									]
								}
							]
						}
					]
				}
			}
		},
		<span style="color:#f92672">&#34;S3GuestReadPolicy&#34;</span>: {
			<span style="color:#f92672">&#34;DependsOn&#34;</span>: [
				<span style="color:#e6db74">&#34;S3Bucket&#34;</span>
			],
			<span style="color:#f92672">&#34;Condition&#34;</span>: <span style="color:#e6db74">&#34;GuestReadAndList&#34;</span>,
			<span style="color:#f92672">&#34;Type&#34;</span>: <span style="color:#e6db74">&#34;AWS::IAM::Policy&#34;</span>,
			<span style="color:#f92672">&#34;Properties&#34;</span>: {
				<span style="color:#f92672">&#34;PolicyName&#34;</span>: {
					<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;s3ReadPolicy&#34;</span>
				},
				<span style="color:#f92672">&#34;Roles&#34;</span>: [
					{
						<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;unauthRoleName&#34;</span>
					}
				],
				<span style="color:#f92672">&#34;PolicyDocument&#34;</span>: {
					<span style="color:#f92672">&#34;Version&#34;</span>: <span style="color:#e6db74">&#34;2012-10-17&#34;</span>,
					<span style="color:#f92672">&#34;Statement&#34;</span>: [
						{
							<span style="color:#f92672">&#34;Effect&#34;</span>: <span style="color:#e6db74">&#34;Allow&#34;</span>,
							<span style="color:#f92672">&#34;Action&#34;</span>: [
								<span style="color:#e6db74">&#34;s3:GetObject&#34;</span>
							],
							<span style="color:#f92672">&#34;Resource&#34;</span>: [
								{
									<span style="color:#f92672">&#34;Fn::Join&#34;</span>: [
										<span style="color:#e6db74">&#34;&#34;</span>,
										[
											<span style="color:#e6db74">&#34;arn:aws:s3:::&#34;</span>,
											{
												<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;S3Bucket&#34;</span>
											},
											<span style="color:#e6db74">&#34;/protected/*&#34;</span>
										]
									]
								}
							]
						},
						{
							<span style="color:#f92672">&#34;Effect&#34;</span>: <span style="color:#e6db74">&#34;Allow&#34;</span>,
							<span style="color:#f92672">&#34;Action&#34;</span>: [
								<span style="color:#e6db74">&#34;s3:ListBucket&#34;</span>
							],
							<span style="color:#f92672">&#34;Resource&#34;</span>: [
								{
									<span style="color:#f92672">&#34;Fn::Join&#34;</span>: [
										<span style="color:#e6db74">&#34;&#34;</span>,
										[
											<span style="color:#e6db74">&#34;arn:aws:s3:::&#34;</span>,
											{
												<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;S3Bucket&#34;</span>
											}
										]
									]
								}
							],
							<span style="color:#f92672">&#34;Condition&#34;</span>: {
								<span style="color:#f92672">&#34;StringLike&#34;</span>: {
									<span style="color:#f92672">&#34;s3:prefix&#34;</span>: [
										<span style="color:#e6db74">&#34;public/&#34;</span>,
										<span style="color:#e6db74">&#34;public/*&#34;</span>,
										<span style="color:#e6db74">&#34;protected/&#34;</span>,
										<span style="color:#e6db74">&#34;protected/*&#34;</span>
									]
								}
							}
						}
					]
				}
			}
		}
	},
	<span style="color:#f92672">&#34;Outputs&#34;</span>: {
		<span style="color:#f92672">&#34;BucketName&#34;</span>: {
			<span style="color:#f92672">&#34;Value&#34;</span>: {
				<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;S3Bucket&#34;</span>
			},
			<span style="color:#f92672">&#34;Description&#34;</span>: <span style="color:#e6db74">&#34;Bucket name for the S3 bucket&#34;</span>
		},
		<span style="color:#f92672">&#34;Region&#34;</span>: {
			<span style="color:#f92672">&#34;Value&#34;</span>: {
				<span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;AWS::Region&#34;</span>
			}
		}
	}
}</code></pre></div>
</div></p></li>

<li><p><strong>photo-albums 디렉터리에서</strong> <code>amplify push</code> 실행하여 저장소 구성을 갱신합니다.</p></li>

<li><p>완료될 때까지 기다립니다. 이 단계는 1~2분 정도 소요됩니다.</p></li>
</ol>

<h3 id="s3-cloudformation-template-json-에서-변경한-내용">s3-cloudformation-template.json 에서 변경한 내용</h3>

<ul>
<li><p>PhotoProcessor 람다 함수를 호출할 수 있도록 S3Bucket 리소스에 권한을 부여하는 <em>InvokePhotoProcessorLambda</em> 리소스를 추가하였습니다.</p></li>

<li><p>새 사진이 &lsquo;uploads/&rsquo; 접두어로 추가되었을 때에 PhotoProcessor 람다함수를 호출하도록 버킷을 구성하게 S3Bucket 리소스에 <em>NotificationConfiguration</em> 속성을 추가하였습니다.</p></li>

<li><p>인증된 사용자가 S3 버킷 내용 목록을 보는 것을 방지하기 위해 <em>DenyListS3Buckets</em> 라는 IAM 정책을 추가하였습니다.</p></li>
</ul>

<p><div class="notices info" ><p>S3 스토리지의 사용자 파일의 기본 권한은 Amplify CLI에서 &lsquo;public/&rsquo;(과 다른 일부 접두어도)으로 시작하는 버킷이라면 어플리케이션에 로그인한 사용자가 버킷 내용을 나열할 수 있게 설정합니다. 이런 상호작용은 어플리케이션에서 노출하지 않으니, 어플리케이션을 찔러보는 누군가는 어플리케이션에 자격증명(credential)을 가져와서 S3 API를 직접 호출하여 모든 사진이 있는 버킷을 나열하는 시도를 할 수 있습니다.
<br/>
<br/>
사용자가 버킷 내용을 모두 열거할 필요는 없으니 인증된 사용자가 S3 버킷 내용을 나열 할 수 있는 기능을 명시적으로 거부하도록 IAM 정책을 역할로 추가했습니다.
<br/>
<br/>
이제 아무도 S3 API로 직접 호출하여 사용자가 업로드한 사진을 나열할 수 없습니다. 앨범과 사진의 ID로 UUID를 사용하기 때문에 사진을 찾기 위해 ID 패턴을 열거하는 호기심 많은 사용자들도 걱정할 필요없습니다.</p>
</div>
</p>

<h3 id="다른-사진-업로드-시도">다른 사진 업로드 시도</h3>

<p>이러한 변경 사항이 완료되면, 사진을 업로드할 수 있고 사진 처리 함수가 자동으로 실행되는 것을 확인할 수 있습니다. 사진을 앨범에 업로드하고 잠시 기다린 다음 페이지를 새로 고침하여 앨범이 새로 업로드된 사진을 표시하는지 확인하십시요. 사진이 표시되면 사진 처리 함수가 업로드에 의해 자동으로 시작되어 썸네일 이미지가 생성되고 AppSync API가 읽은 처리된 사진의 정보들도 DynamoDB 테이블에 모두 추가되었음을 의미합니다.</p>

<p>새로운 사진을 보기 위해 앨범보기를 새로 고치는 것은 좋은 사용자 경험이 아니지만, 이 워크샵에는 이미 많은 내용이 있고 다음장에도  더 많은 내용이 수록되어 있습니다. 짧게 말씀드려본다면, 다른 AppSync 구독으로 이것을 처리하는 한가지 방법은 사진 처리 람다 함수가 AppSync API에서 수정사항을 발생시키고 AlbumDetailsLoader 컴포넌트에서 해당 수정사항을 구독하는 것입니다. 그런데 AppSync API에 Amazon Cognito 사용자 풀 인증을 사용하고 있기 때문에, 람다 기능을 통해 이러한 수정사항을 일으키는 유일한 방법은 일종의 &lsquo;시스템&rsquo; 사용자를 만들고(일반 사용자 가입 및 확인 프로세스를 통해), 사용자 자격증명을 안전하게 저장하고(AWS Secrets Manager 등으로), 수정사항을 유발하도록 람다 내부에서 AppSync API에 사용자로서 인증하는 방법입니다. 간단히 하기위해 여기서는 계속해서 앨범보기를 새로 고치는 방법으로 진행할 것입니다.</p>


<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


        
            <a class="nav nav-prev" href="https://awskrug.github.io/amplify-photo-gallery-workshop/70_generating_thumbnails/10_creating_a_photo_processor_lambda.html" title="사진을 처리하는 람다 함수 만들기"> <i class="fa fa-chevron-left"></i></a>
        
        
            <a class="nav nav-next" href="https://awskrug.github.io/amplify-photo-gallery-workshop/110_ai.html" title="AI 추가하기" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
        
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/clipboard.min.js?1558848519"></script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/perfect-scrollbar.min.js?1558848519"></script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/perfect-scrollbar.jquery.min.js?1558848519"></script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/jquery.sticky.js?1558848519"></script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/featherlight.min.js?1558848519"></script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/html5shiv-printshiv.min.js?1558848519"></script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/highlight.pack.js?1558848519"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/modernizr.custom.71422.js?1558848519"></script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/learn.js?1558848519"></script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/hugo-learn.js?1558848519"></script>

    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/mermaid/mermaid.css?1558848519" type="text/css" rel="stylesheet" />
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/mermaid/mermaid.js?1558848519"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

