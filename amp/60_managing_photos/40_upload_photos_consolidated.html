<!DOCTYPE html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<html lang="ko" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta property="og:title" content="Amplify + AppSync Workshop" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://amplify-workshop.go-aws.com" />
    <meta property="og:image" content="https://amplify-workshop.go-aws.com/images/architecture.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.45.1" />
    <meta name="description" content="Amplify / AppSync / React Workshop">
<meta name="author" content="Gabe Hollombe">

    <link rel="shortcut icon" href="https://awskrug.github.io/amplify-photo-gallery-workshop/images/favicon.png" type="image/x-icon" />
<link rel="icon" href="https://awskrug.github.io/amplify-photo-gallery-workshop/images/favicon.png" type="image/x-icon" />
    <title>사진 관리하기 :: Amplify / AppSync / React Workshop</title>

    
    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/nucleus.css?1558848519" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/hybrid.css?1558848519" rel="stylesheet">
    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/featherlight.min.css?1558848519" rel="stylesheet">
    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/perfect-scrollbar.min.css?1558848519" rel="stylesheet">
    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/auto-complete.css?1558848519" rel="stylesheet">
    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/theme.css?1558848519" rel="stylesheet">
    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/hugo-theme.css?1558848519" rel="stylesheet">
    
      <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/theme-mine.css?1558848519" rel="stylesheet">
    

    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/jquery-ui.min.css?1558848519" rel="stylesheet">
    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/jquery-ui.structure.min.css?1558848519" rel="stylesheet">
    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/css/jquery-ui.theme.min.css?1558848519" rel="stylesheet">
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/jquery-2.x.min.js?1558848519"></script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/jquery-ui.min.js?1558848519"></script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/tabs.js?1558848519"></script>

    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/60_managing_photos/40_upload_photos_consolidated.html">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/" title="Go home"><svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 30" width="60%" style="padding:20px 0px;"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg></a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fa fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="">
    <span data-search-clear=""><i class="fa fa-close"></i></span>
</div>

<script type="text/javascript" src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/lunr.min.js?1558848519"></script>
<script type="text/javascript" src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/auto-complete.js?1558848519"></script>
<script type="text/javascript">
    
        var baseurl = '\/';
    
</script>
<script type="text/javascript" src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/search.js?1558848519"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/10_prerequisites.html" title="사전준비" class="dd-item 
        
        
        
        ">
      <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/10_prerequisites.html">
          사전준비
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/10_prerequisites/1_account.html" title="AWS account 생성하기" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/10_prerequisites/1_account.html">
        AWS account 생성하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/10_prerequisites/10_workspace.html" title="Cloud9 Workspace 생성하기" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/10_prerequisites/10_workspace.html">
        Cloud9 Workspace 생성하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/10_prerequisites/20_software.html" title="설치 &amp; 설정" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/10_prerequisites/20_software.html">
        설치 &amp; 설정
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/20_getting_started.html" title="시작하기" class="dd-item 
        
        
        
        ">
      <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/20_getting_started.html">
          시작하기
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/20_getting_started/10_what_we_will_build.html" title="무엇을 빌드하나" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/20_getting_started/10_what_we_will_build.html">
        무엇을 빌드하나
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/20_getting_started/20_bootstrapping_the_app.html" title="어플리케이션 부트스트래핑" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/20_getting_started/20_bootstrapping_the_app.html">
        어플리케이션 부트스트래핑
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/30_adding_auth.html" title="인증 추가하기" class="dd-item 
        
        
        
        ">
      <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/30_adding_auth.html">
          인증 추가하기
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/30_adding_auth/10_adding_auth_back.html" title="백엔드 구성하기" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/30_adding_auth/10_adding_auth_back.html">
        백엔드 구성하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/30_adding_auth/20_adding_auth_front.html" title="프론트엔드 렌더링" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/30_adding_auth/20_adding_auth_front.html">
        프론트엔드 렌더링
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/40_graphql.html" title="GraphQL API 생성하기" class="dd-item 
        
        
        
        ">
      <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/40_graphql.html">
          GraphQL API 생성하기
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/40_graphql/10_setting_up_appsync.html" title="AppSync 세팅" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/40_graphql/10_setting_up_appsync.html">
        AppSync 세팅
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/40_graphql/20_trying_out_queries.html" title="Querie 수행하기" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/40_graphql/20_trying_out_queries.html">
        Querie 수행하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/50_working_with_albums.html" title="앨범 작업" class="dd-item 
        
        
        
        ">
      <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/50_working_with_albums.html">
          앨범 작업
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/50_working_with_albums/5_managing_albums.html" title="앨범 관리" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/50_working_with_albums/5_managing_albums.html">
        앨범 관리
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/60_managing_photos.html" title="사진 관리하기" class="dd-item 
        parent
        
        
        ">
      <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/60_managing_photos.html">
          사진 관리하기
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/60_managing_photos/30_adding_storage.html" title="Cloud Storage 추가하기" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/60_managing_photos/30_adding_storage.html">
        Cloud Storage 추가하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/60_managing_photos/40_upload_photos_consolidated.html" title="사진 관리하기" class="dd-item active">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/60_managing_photos/40_upload_photos_consolidated.html">
        사진 관리하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/70_generating_thumbnails.html" title="미리보기 만들기" class="dd-item 
        
        
        
        ">
      <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/70_generating_thumbnails.html">
          미리보기 만들기
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/70_generating_thumbnails/10_creating_a_photo_processor_lambda.html" title="사진을 처리하는 람다 함수 만들기" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/70_generating_thumbnails/10_creating_a_photo_processor_lambda.html">
        사진을 처리하는 람다 함수 만들기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/70_generating_thumbnails/20_connecting_the_lambda_to_the_bucket.html" title="사진 버킷을 처리함수와 연결하기" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/70_generating_thumbnails/20_connecting_the_lambda_to_the_bucket.html">
        사진 버킷을 처리함수와 연결하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/110_ai.html" title="AI 추가하기" class="dd-item 
        
        
        
        ">
      <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/110_ai.html">
          AI 추가하기
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/110_ai/10_rekognition.html" title="Amazon Rekognition 연동하기" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/110_ai/10_rekognition.html">
        Amazon Rekognition 연동하기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/110_ai/20_prep_for_searching.html" title="사진을 검색할 수 있게 만들기" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/110_ai/20_prep_for_searching.html">
        사진을 검색할 수 있게 만들기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/110_ai/40_searching_for_labels.html" title="사진을 레이블로 검색하기" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/110_ai/40_searching_for_labels.html">
        사진을 레이블로 검색하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/120_deploying.html" title="어플리케이션 배포하기" class="dd-item 
        
        
        
        ">
      <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/120_deploying.html">
          어플리케이션 배포하기
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/120_deploying/10_deploying.html" title="S3에 어플리케이션 배포하기" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/120_deploying/10_deploying.html">
        S3에 어플리케이션 배포하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/130_wrapping_up.html" title="마무리하기" class="dd-item 
        
        
        
        ">
      <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/130_wrapping_up.html">
          마무리하기
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/130_wrapping_up/10_what_we_built.html" title="축하드립니다!" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/130_wrapping_up/10_what_we_built.html">
        축하드립니다!
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/130_wrapping_up/20_cleanup.html" title="리소스 삭제하기" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/130_wrapping_up/20_cleanup.html">
        리소스 삭제하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/140_bonus.html" title="보너스 컨텐츠" class="dd-item 
        
        
        
        ">
      <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/140_bonus.html">
          보너스 컨텐츠
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/140_bonus/10_lightbox_photos.html" title="LIGHTBOX 만들어 전체 크기의 사진들 보기" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/140_bonus/10_lightbox_photos.html">
        LIGHTBOX 만들어 전체 크기의 사진들 보기
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/140_bonus/20_album_membership.html" title="다른 유저와 앨범 공유하기" class="dd-item ">
        <a href="https://geoseong.github.io/amplify-photo-gallery-workshop/140_bonus/20_album_membership.html">
        다른 유저와 앨범 공유하기
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3></h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://twitter.com/intent/user?screen_name=gabehollombe"><i class='fab fa-twitter fa-lg'></i> @gabehollombe</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <left>

    <h2 class="github-title">Github Repo</h2>

    <h3 class="github-title">Amplify Photo Gallery Workshop</h3>
    <a class="github-button" href="https://github.com/aws-samples/amplify-photo-gallery-workshop" data-icon="octicon-star" data-show-count="true" aria-label="Star on GitHub">Star</a>
    &nbsp;<a class="github-button" href="https://github.com/aws-samples/amplify-photo-gallery-workshop/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork on GitHub">Fork</a><br />

    <h5 class="copyright">&copy; 2018 Amazon Web Services, Inc. or its Affiliates. All rights reserved.<h5>

</left>

<script async defer src="https://buttons.github.io/buttons.js"></script> 

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fa fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            <a href='https://awskrug.github.io/amplify-photo-gallery-workshop/'>Amplify Web App Workshop</a> > <a href='https://awskrug.github.io/amplify-photo-gallery-workshop/60_managing_photos.html'>사진 관리하기</a> > 사진 관리하기
          
        
          
        
          
        
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#src-app-js-변경사항">src/App.js 변경사항</a></li>
<li><a href="#사진-업로드-하기">사진 업로드 하기</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>사진 관리하기</h1>
          

        




<p>사진을 저장할수 있는 S3 bucket이 생겼으니 사진을 버킷에 사진을 업로드 하도록 도와줄 UI가 필요합니다. 그리고 앨범에 속한 모든 사진들을 로드 하기 위해서 사진들이 앨범에서 어떤 특정 부분에 속하는지 추적 할수 있어야 합니다.</p>

<p>새로운 <em>S3ImageUpload</em> 컴포넌트를 만들어 봅시다. 이 컴포넌트는 사용자가 사진을 선택할때 이벤트 핸들러를 실행시키는 input 엘리먼트를 가진 HTML이 포함되어 있습니다.</p>

<div class="notices info" ><p>업로드 이벤트 핸들러를 통해 사진이 어떤 앨범에 들어갈지 설명하는 주석을 가진 메터데이터가 있는 파일을 S3에 업로드 합니다. 다행히 <a href="https://aws-amplify.github.io/amplify-js/media/storage_guide" target="_blank">Amplify JS Storage module</a>을 이용하면 S3에 파일업로드 작업을 매우 쉽게 할 수 있습니다.
그리고, 반드시 고유한 이름으로 S3에 파일을 업로드 해야하기 때문에 UUID를 생성해주는 의존 라이브러리가 필요합니다. (사용자 기기에 있는 파일 이름을 그대로 사용한다면 이름 중복 충돌이 발생할수 있습니다).</p>
</div>


<p><strong>photo-albums 디렉토리에서 다음을 수행합니다.</strong> <code>npm install --save uuid</code></p>

<p>우리 어플리케이션에 의존 라이브러리를 추가하고 S3ImageUpload 컴포넌트를 생성합니다. 그리고 컴포넌트에 생성한 S3ImageUpload 컴포넌트를 포함합니다.</p>

<p><strong>photo-albums/src/App.js</strong>의 내용을 아래 코드로 교체합니다:
<div style="height: 660px; overflow-y: scroll;">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="color:#75715e">// src/App.js
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span>, { <span style="color:#a6e22e">Component</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>;

<span style="color:#66d9ef">import</span> {<span style="color:#a6e22e">BrowserRouter</span> <span style="color:#a6e22e">as</span> <span style="color:#a6e22e">Router</span>, <span style="color:#a6e22e">Route</span>, <span style="color:#a6e22e">NavLink</span>} <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react-router-dom&#39;</span>;
<span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#66d9ef">import</span> {<span style="color:#a6e22e">Divider</span>, <span style="color:#a6e22e">Form</span>, <span style="color:#a6e22e">Grid</span>, <span style="color:#a6e22e">Header</span>, <span style="color:#a6e22e">Input</span>, <span style="color:#a6e22e">List</span>, <span style="color:#a6e22e">Segment</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;semantic-ui-react&#39;</span>;
</span><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#66d9ef">import</span> {<span style="color:#a6e22e">v4</span> <span style="color:#a6e22e">as</span> <span style="color:#a6e22e">uuid</span>} <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;uuid&#39;</span>;
</span>
<span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Connect</span>, <span style="color:#a6e22e">withAuthenticator</span>, <span style="color:#a6e22e">S3Image</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;aws-amplify-react&#39;</span>;
</span><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Amplify</span>, { <span style="color:#a6e22e">API</span>, <span style="color:#a6e22e">graphqlOperation</span>, <span style="color:#a6e22e">Storage</span>, <span style="color:#a6e22e">Auth</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;aws-amplify&#39;</span>;
</span>
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">aws_exports</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./aws-exports&#39;</span>;
<span style="color:#a6e22e">Amplify</span>.<span style="color:#a6e22e">configure</span>(<span style="color:#a6e22e">aws_exports</span>);


<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">makeComparator</span>(<span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">order</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;asc&#39;</span>) {
  <span style="color:#66d9ef">return</span> (<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) =&gt; {
    <span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">hasOwnProperty</span>(<span style="color:#a6e22e">key</span>) <span style="color:#f92672">||</span> <span style="color:#f92672">!</span><span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">hasOwnProperty</span>(<span style="color:#a6e22e">key</span>)) <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>; 
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">aVal</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">typeof</span> <span style="color:#a6e22e">a</span>[<span style="color:#a6e22e">key</span>] <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;string&#39;</span>) <span style="color:#f92672">?</span> <span style="color:#a6e22e">a</span>[<span style="color:#a6e22e">key</span>].<span style="color:#a6e22e">toUpperCase</span>() <span style="color:#f92672">:</span> <span style="color:#a6e22e">a</span>[<span style="color:#a6e22e">key</span>];
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">bVal</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">typeof</span> <span style="color:#a6e22e">b</span>[<span style="color:#a6e22e">key</span>] <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;string&#39;</span>) <span style="color:#f92672">?</span> <span style="color:#a6e22e">b</span>[<span style="color:#a6e22e">key</span>].<span style="color:#a6e22e">toUpperCase</span>() <span style="color:#f92672">:</span> <span style="color:#a6e22e">b</span>[<span style="color:#a6e22e">key</span>];
    
    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">comparison</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">aVal</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">bVal</span>) <span style="color:#a6e22e">comparison</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">aVal</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">bVal</span>) <span style="color:#a6e22e">comparison</span> <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;

    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">order</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;desc&#39;</span> <span style="color:#f92672">?</span> (<span style="color:#a6e22e">comparison</span> <span style="color:#f92672">*</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">:</span> <span style="color:#a6e22e">comparison</span>
  };
}


<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ListAlbums</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`query ListAlbums {
</span><span style="color:#e6db74">    listAlbums(limit: 9999) {
</span><span style="color:#e6db74">        items {
</span><span style="color:#e6db74">            id
</span><span style="color:#e6db74">            name
</span><span style="color:#e6db74">        }
</span><span style="color:#e6db74">    }
</span><span style="color:#e6db74">}`</span>;

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">SubscribeToNewAlbums</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`
</span><span style="color:#e6db74">  subscription OnCreateAlbum {
</span><span style="color:#e6db74">    onCreateAlbum {
</span><span style="color:#e6db74">      id
</span><span style="color:#e6db74">      name
</span><span style="color:#e6db74">    }
</span><span style="color:#e6db74">  }
</span><span style="color:#e6db74">`</span>;


<span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">GetAlbum</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`query GetAlbum($id: ID!, $nextTokenForPhotos: String) {
</span></span><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#e6db74">  getAlbum(id: $id) {
</span></span><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#e6db74">    id
</span></span><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#e6db74">    name
</span></span><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#e6db74">    photos(sortDirection: DESC, nextToken: $nextTokenForPhotos) {
</span></span><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#e6db74">      nextToken
</span></span><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#e6db74">      items {
</span></span><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#e6db74">        thumbnail {
</span></span><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#e6db74">          width
</span></span><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#e6db74">          height
</span></span><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#e6db74">          key
</span></span><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#e6db74">        }
</span></span><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#e6db74">      }
</span></span><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#e6db74">    }
</span></span><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#e6db74">  }
</span></span><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#e6db74">}`</span>;
</span><span style="display:block;width:100%;background-color:#3c3d38">
</span><span style="display:block;width:100%;background-color:#3c3d38">
</span><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">S3ImageUpload</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">Component</span> {
</span><span style="display:block;width:100%;background-color:#3c3d38">  <span style="color:#a6e22e">constructor</span>(<span style="color:#a6e22e">props</span>) {
</span><span style="display:block;width:100%;background-color:#3c3d38">    <span style="color:#66d9ef">super</span>(<span style="color:#a6e22e">props</span>);
</span><span style="display:block;width:100%;background-color:#3c3d38">    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">state</span> <span style="color:#f92672">=</span> { <span style="color:#a6e22e">uploading</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">false</span> }
</span><span style="display:block;width:100%;background-color:#3c3d38">  }
</span><span style="display:block;width:100%;background-color:#3c3d38">  
</span><span style="display:block;width:100%;background-color:#3c3d38">  <span style="color:#a6e22e">uploadFile</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> (<span style="color:#a6e22e">file</span>) =&gt; {
</span><span style="display:block;width:100%;background-color:#3c3d38">    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fileName</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">uuid</span>();
</span><span style="display:block;width:100%;background-color:#3c3d38">    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">user</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">Auth</span>.<span style="color:#a6e22e">currentAuthenticatedUser</span>();
</span><span style="display:block;width:100%;background-color:#3c3d38">    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">Storage</span>.<span style="color:#a6e22e">put</span>(
</span><span style="display:block;width:100%;background-color:#3c3d38">      <span style="color:#a6e22e">fileName</span>, 
</span><span style="display:block;width:100%;background-color:#3c3d38">      <span style="color:#a6e22e">file</span>, 
</span><span style="display:block;width:100%;background-color:#3c3d38">      {
</span><span style="display:block;width:100%;background-color:#3c3d38">        <span style="color:#a6e22e">customPrefix</span><span style="color:#f92672">:</span> { <span style="color:#66d9ef">public</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;uploads/&#39;</span> },
</span><span style="display:block;width:100%;background-color:#3c3d38">        <span style="color:#a6e22e">metadata</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">albumid</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">props</span>.<span style="color:#a6e22e">albumId</span>, <span style="color:#a6e22e">owner</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">username</span> }
</span><span style="display:block;width:100%;background-color:#3c3d38">      }
</span><span style="display:block;width:100%;background-color:#3c3d38">    );
</span><span style="display:block;width:100%;background-color:#3c3d38">
</span><span style="display:block;width:100%;background-color:#3c3d38">    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Uploaded file: &#39;</span>, <span style="color:#a6e22e">result</span>);
</span><span style="display:block;width:100%;background-color:#3c3d38">  }
</span><span style="display:block;width:100%;background-color:#3c3d38">
</span><span style="display:block;width:100%;background-color:#3c3d38">  <span style="color:#a6e22e">onChange</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> (<span style="color:#a6e22e">e</span>) =&gt; {
</span><span style="display:block;width:100%;background-color:#3c3d38">    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">setState</span>({<span style="color:#a6e22e">uploading</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>});
</span><span style="display:block;width:100%;background-color:#3c3d38">    
</span><span style="display:block;width:100%;background-color:#3c3d38">    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">files</span> <span style="color:#f92672">=</span> [];
</span><span style="display:block;width:100%;background-color:#3c3d38">    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span>&lt;<span style="color:#f92672">e</span><span style="color:#a6e22e">.target.files.length</span><span style="color:#960050;background-color:#1e0010">;</span> <span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">++)</span> {
</span><span style="display:block;width:100%;background-color:#3c3d38">      <span style="color:#a6e22e">files.push</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">e.target.files.item</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">));</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">    }
</span><span style="display:block;width:100%;background-color:#3c3d38">    <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">Promise.all</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">files.map</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">f </span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&gt;</span> <span style="color:#e6db74">this.uploadFile(f)));</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">
</span><span style="display:block;width:100%;background-color:#3c3d38">    <span style="color:#a6e22e">this.setState</span><span style="color:#960050;background-color:#1e0010">(</span>{<span style="color:#a6e22e">uploading</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#a6e22e">false</span>}<span style="color:#960050;background-color:#1e0010">);</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">  }
</span><span style="display:block;width:100%;background-color:#3c3d38">
</span><span style="display:block;width:100%;background-color:#3c3d38">  <span style="color:#a6e22e">render</span><span style="color:#960050;background-color:#1e0010">()</span> {
</span><span style="display:block;width:100%;background-color:#3c3d38">    <span style="color:#a6e22e">return</span> <span style="color:#960050;background-color:#1e0010">(</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">      <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">div</span>&gt;
</span><span style="display:block;width:100%;background-color:#3c3d38">        &lt;<span style="color:#f92672">Form</span><span style="color:#a6e22e">.Button</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">          <span style="color:#a6e22e">onClick</span><span style="color:#f92672">=</span><span style="color:#e6db74">{()</span> <span style="color:#960050;background-color:#1e0010">=</span>&gt; document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;add-image-file-input&#39;</span>).<span style="color:#a6e22e">click</span>()}
</span><span style="display:block;width:100%;background-color:#3c3d38">          <span style="color:#a6e22e">disabled</span><span style="color:#f92672">=</span>{<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">state</span>.<span style="color:#a6e22e">uploading</span>}
</span><span style="display:block;width:100%;background-color:#3c3d38">          <span style="color:#a6e22e">icon</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;file image outline&#39;</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">          <span style="color:#a6e22e">content</span><span style="color:#f92672">=</span>{ <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">state</span>.<span style="color:#a6e22e">uploading</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">&#39;Uploading...&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Add Images&#39;</span> }
</span><span style="display:block;width:100%;background-color:#3c3d38">        <span style="color:#960050;background-color:#1e0010">/&gt;</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">        &lt;<span style="color:#f92672">input</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">          <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;add-image-file-input&#39;</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">          <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;file&#34;</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">          <span style="color:#a6e22e">accept</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;image/*&#39;</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">          <span style="color:#a6e22e">multiple</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">          <span style="color:#a6e22e">onChange</span><span style="color:#f92672">=</span><span style="color:#e6db74">{this.onChange}</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">          <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">{{</span> <span style="color:#a6e22e">display</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">none</span><span style="color:#960050;background-color:#1e0010">&#39;</span> }}
</span><span style="display:block;width:100%;background-color:#3c3d38">        /&gt;
</span><span style="display:block;width:100%;background-color:#3c3d38">      &lt;/<span style="color:#f92672">div</span>&gt;
</span><span style="display:block;width:100%;background-color:#3c3d38">    );
</span><span style="display:block;width:100%;background-color:#3c3d38">  }
</span><span style="display:block;width:100%;background-color:#3c3d38">}
</span><span style="display:block;width:100%;background-color:#3c3d38">
</span><span style="display:block;width:100%;background-color:#3c3d38">
</span><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PhotosList</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">Component</span> {
</span><span style="display:block;width:100%;background-color:#3c3d38">  <span style="color:#a6e22e">photoItems</span>() {
</span><span style="display:block;width:100%;background-color:#3c3d38">    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">props</span>.<span style="color:#a6e22e">photos</span>.<span style="color:#a6e22e">map</span>(<span style="color:#a6e22e">photo</span> =&gt;
</span><span style="display:block;width:100%;background-color:#3c3d38">      &lt;<span style="color:#f92672">S3Image</span> 
</span><span style="display:block;width:100%;background-color:#3c3d38">        <span style="color:#a6e22e">key</span><span style="color:#f92672">=</span><span style="color:#e6db74">{photo.thumbnail.key}</span> 
</span><span style="display:block;width:100%;background-color:#3c3d38">        <span style="color:#a6e22e">imgKey</span><span style="color:#f92672">=</span><span style="color:#e6db74">{photo.thumbnail.key.replace(&#39;public/&#39;,</span> <span style="color:#960050;background-color:#1e0010">&#39;&#39;)</span>} 
</span><span style="display:block;width:100%;background-color:#3c3d38">        <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">{{display:</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">inline</span><span style="color:#960050;background-color:#1e0010">-</span><span style="color:#a6e22e">block</span><span style="color:#960050;background-color:#1e0010">&#39;,</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">paddingRight</span><span style="color:#960050;background-color:#1e0010">&#39;:</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">5px</span><span style="color:#960050;background-color:#1e0010">&#39;</span>}}
</span><span style="display:block;width:100%;background-color:#3c3d38">      /&gt;
</span><span style="display:block;width:100%;background-color:#3c3d38">    );
</span><span style="display:block;width:100%;background-color:#3c3d38">  }
</span><span style="display:block;width:100%;background-color:#3c3d38">
</span><span style="display:block;width:100%;background-color:#3c3d38">  <span style="color:#a6e22e">render</span>() {
</span><span style="display:block;width:100%;background-color:#3c3d38">    <span style="color:#66d9ef">return</span> (
</span><span style="display:block;width:100%;background-color:#3c3d38">      &lt;<span style="color:#f92672">div</span>&gt;
</span><span style="display:block;width:100%;background-color:#3c3d38">        &lt;<span style="color:#f92672">Divider</span> <span style="color:#a6e22e">hidden</span> /&gt;
</span><span style="display:block;width:100%;background-color:#3c3d38">        {<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">photoItems</span>()}
</span><span style="display:block;width:100%;background-color:#3c3d38">      &lt;/<span style="color:#f92672">div</span>&gt;
</span><span style="display:block;width:100%;background-color:#3c3d38">    );
</span><span style="display:block;width:100%;background-color:#3c3d38">  }
</span><span style="display:block;width:100%;background-color:#3c3d38">}
</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NewAlbum</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">Component</span> {
  <span style="color:#a6e22e">constructor</span>(<span style="color:#a6e22e">props</span>) {
    <span style="color:#66d9ef">super</span>(<span style="color:#a6e22e">props</span>);
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">state</span> <span style="color:#f92672">=</span> {
      <span style="color:#a6e22e">albumName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;&#39;</span>
      };
    }

  <span style="color:#a6e22e">handleChange</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">event</span>) =&gt; {
    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">change</span> <span style="color:#f92672">=</span> {};
    <span style="color:#a6e22e">change</span>[<span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">target</span>.<span style="color:#a6e22e">name</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">target</span>.<span style="color:#a6e22e">value</span>;
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">setState</span>(<span style="color:#a6e22e">change</span>);
  }

  <span style="color:#a6e22e">handleSubmit</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> (<span style="color:#a6e22e">event</span>) =&gt; {
    <span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">preventDefault</span>();
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">NewAlbum</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`mutation NewAlbum($name: String!) {
</span><span style="color:#e6db74">      createAlbum(input: {name: $name}) {
</span><span style="color:#e6db74">        id
</span><span style="color:#e6db74">        name
</span><span style="color:#e6db74">      }
</span><span style="color:#e6db74">    }`</span>;
    
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">API</span>.<span style="color:#a6e22e">graphql</span>(<span style="color:#a6e22e">graphqlOperation</span>(<span style="color:#a6e22e">NewAlbum</span>, { <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">state</span>.<span style="color:#a6e22e">albumName</span> }));
    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">info</span>(<span style="color:#e6db74">`Created album with id </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">createAlbum</span>.<span style="color:#a6e22e">id</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">setState</span>({ <span style="color:#a6e22e">albumName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;&#39;</span> })
  }

  <span style="color:#a6e22e">render</span>() {
    <span style="color:#66d9ef">return</span> (
      &lt;<span style="color:#f92672">Segment</span>&gt;
        &lt;<span style="color:#f92672">Header</span> <span style="color:#a6e22e">as</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;h3&#39;</span>&gt;<span style="color:#a6e22e">Add</span> <span style="color:#a6e22e">a</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">album</span>&lt;/<span style="color:#f92672">Header</span>&gt;
          &lt;<span style="color:#f92672">Input</span>
          <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;text&#39;</span>
          <span style="color:#a6e22e">placeholder</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;New Album Name&#39;</span>
          <span style="color:#a6e22e">icon</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;plus&#39;</span>
          <span style="color:#a6e22e">iconPosition</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;left&#39;</span>
          <span style="color:#a6e22e">action</span><span style="color:#f92672">=</span><span style="color:#e6db74">{{</span> <span style="color:#a6e22e">content</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">Create</span><span style="color:#960050;background-color:#1e0010">&#39;,</span> <span style="color:#a6e22e">onClick</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#a6e22e">this.handleSubmit</span> }}
          <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;albumName&#39;</span>
          <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">{this.state.albumName}</span>
          <span style="color:#a6e22e">onChange</span><span style="color:#f92672">=</span><span style="color:#e6db74">{this.handleChange}</span>
          /&gt;
        &lt;/<span style="color:#f92672">Segment</span>&gt;
      )
    }
}


<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AlbumsList</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">Component</span> {
  <span style="color:#a6e22e">albumItems</span>() {
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">props</span>.<span style="color:#a6e22e">albums</span>.<span style="color:#a6e22e">sort</span>(<span style="color:#a6e22e">makeComparator</span>(<span style="color:#e6db74">&#39;name&#39;</span>)).<span style="color:#a6e22e">map</span>(<span style="color:#a6e22e">album</span> =&gt;
      &lt;<span style="color:#f92672">List</span><span style="color:#a6e22e">.Item</span> <span style="color:#a6e22e">key</span><span style="color:#f92672">=</span><span style="color:#e6db74">{album.id}</span>&gt;
        &lt;<span style="color:#f92672">NavLink</span> <span style="color:#a6e22e">to</span><span style="color:#f92672">=</span><span style="color:#e6db74">{`/albums/${album.id}`}</span>&gt;{<span style="color:#a6e22e">album</span>.<span style="color:#a6e22e">name</span>}&lt;/<span style="color:#f92672">NavLink</span>&gt;
      <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/List.Item&gt;</span>
    );
  }

  <span style="color:#a6e22e">render</span>() {
    <span style="color:#66d9ef">return</span> (
      &lt;<span style="color:#f92672">Segment</span>&gt;
        &lt;<span style="color:#f92672">Header</span> <span style="color:#a6e22e">as</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;h3&#39;</span>&gt;<span style="color:#a6e22e">My</span> <span style="color:#a6e22e">Albums</span>&lt;/<span style="color:#f92672">Header</span>&gt;
        &lt;<span style="color:#f92672">List</span> <span style="color:#a6e22e">divided</span> <span style="color:#a6e22e">relaxed</span>&gt;
          {<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">albumItems</span>()}
        &lt;/<span style="color:#f92672">List</span>&gt;
      &lt;/<span style="color:#f92672">Segment</span>&gt;
    );
  }
}
    


<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AlbumDetailsLoader</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">Component</span> {
<span style="display:block;width:100%;background-color:#3c3d38">    <span style="color:#a6e22e">constructor</span>(<span style="color:#a6e22e">props</span>) {
</span><span style="display:block;width:100%;background-color:#3c3d38">        <span style="color:#66d9ef">super</span>(<span style="color:#a6e22e">props</span>);
</span><span style="display:block;width:100%;background-color:#3c3d38">        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">state</span> <span style="color:#f92672">=</span> {
</span><span style="display:block;width:100%;background-color:#3c3d38">            <span style="color:#a6e22e">nextTokenForPhotos</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">null</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">            <span style="color:#a6e22e">hasMorePhotos</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">            <span style="color:#a6e22e">album</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">null</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">            <span style="color:#a6e22e">loading</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">        }
</span><span style="display:block;width:100%;background-color:#3c3d38">    }
</span><span style="display:block;width:100%;background-color:#3c3d38">
</span><span style="display:block;width:100%;background-color:#3c3d38">    <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">loadMorePhotos</span>() {
</span><span style="display:block;width:100%;background-color:#3c3d38">        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">state</span>.<span style="color:#a6e22e">hasMorePhotos</span>) <span style="color:#66d9ef">return</span>;
</span><span style="display:block;width:100%;background-color:#3c3d38">
</span><span style="display:block;width:100%;background-color:#3c3d38">        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">setState</span>({ <span style="color:#a6e22e">loading</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span> });
</span><span style="display:block;width:100%;background-color:#3c3d38">        <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">data</span> } <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">API</span>.<span style="color:#a6e22e">graphql</span>(<span style="color:#a6e22e">graphqlOperation</span>(<span style="color:#a6e22e">GetAlbum</span>, {<span style="color:#a6e22e">id</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">props</span>.<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">nextTokenForPhotos</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">state</span>.<span style="color:#a6e22e">nextTokenForPhotos</span>}));
</span><span style="display:block;width:100%;background-color:#3c3d38">
</span><span style="display:block;width:100%;background-color:#3c3d38">        <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">album</span>;
</span><span style="display:block;width:100%;background-color:#3c3d38">        <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">state</span>.<span style="color:#a6e22e">album</span> <span style="color:#f92672">===</span> <span style="color:#66d9ef">null</span>) {
</span><span style="display:block;width:100%;background-color:#3c3d38">            <span style="color:#a6e22e">album</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">getAlbum</span>;
</span><span style="display:block;width:100%;background-color:#3c3d38">        } <span style="color:#66d9ef">else</span> {
</span><span style="display:block;width:100%;background-color:#3c3d38">            <span style="color:#a6e22e">album</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">state</span>.<span style="color:#a6e22e">album</span>;
</span><span style="display:block;width:100%;background-color:#3c3d38">            <span style="color:#a6e22e">album</span>.<span style="color:#a6e22e">photos</span>.<span style="color:#a6e22e">items</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">album</span>.<span style="color:#a6e22e">photos</span>.<span style="color:#a6e22e">items</span>.<span style="color:#a6e22e">concat</span>(<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">getAlbum</span>.<span style="color:#a6e22e">photos</span>.<span style="color:#a6e22e">items</span>);
</span><span style="display:block;width:100%;background-color:#3c3d38">        }
</span><span style="display:block;width:100%;background-color:#3c3d38">        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">setState</span>({ 
</span><span style="display:block;width:100%;background-color:#3c3d38">            <span style="color:#a6e22e">album</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">album</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">            <span style="color:#a6e22e">loading</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">false</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">            <span style="color:#a6e22e">nextTokenForPhotos</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">getAlbum</span>.<span style="color:#a6e22e">photos</span>.<span style="color:#a6e22e">nextToken</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38">            <span style="color:#a6e22e">hasMorePhotos</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">getAlbum</span>.<span style="color:#a6e22e">photos</span>.<span style="color:#a6e22e">nextToken</span> <span style="color:#f92672">!==</span> <span style="color:#66d9ef">null</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">        });
</span><span style="display:block;width:100%;background-color:#3c3d38">    }
</span><span style="display:block;width:100%;background-color:#3c3d38">
</span><span style="display:block;width:100%;background-color:#3c3d38">    <span style="color:#a6e22e">componentDidMount</span>() {
</span><span style="display:block;width:100%;background-color:#3c3d38">        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">loadMorePhotos</span>();
</span><span style="display:block;width:100%;background-color:#3c3d38">    }
</span><span style="display:block;width:100%;background-color:#3c3d38">
</span><span style="display:block;width:100%;background-color:#3c3d38">    <span style="color:#a6e22e">render</span>() {
</span><span style="display:block;width:100%;background-color:#3c3d38">        <span style="color:#66d9ef">return</span> (
</span><span style="display:block;width:100%;background-color:#3c3d38">            &lt;<span style="color:#f92672">AlbumDetails</span> 
</span><span style="display:block;width:100%;background-color:#3c3d38">                <span style="color:#a6e22e">loadingPhotos</span><span style="color:#f92672">=</span><span style="color:#e6db74">{this.state.loading}</span> 
</span><span style="display:block;width:100%;background-color:#3c3d38">                <span style="color:#a6e22e">album</span><span style="color:#f92672">=</span><span style="color:#e6db74">{this.state.album}</span> 
</span><span style="display:block;width:100%;background-color:#3c3d38">                <span style="color:#a6e22e">loadMorePhotos</span><span style="color:#f92672">=</span><span style="color:#e6db74">{this.loadMorePhotos.bind(this)}</span> 
</span><span style="display:block;width:100%;background-color:#3c3d38">                <span style="color:#a6e22e">hasMorePhotos</span><span style="color:#f92672">=</span><span style="color:#e6db74">{this.state.hasMorePhotos}</span> 
</span><span style="display:block;width:100%;background-color:#3c3d38">            /&gt;
</span><span style="display:block;width:100%;background-color:#3c3d38">        );
</span><span style="display:block;width:100%;background-color:#3c3d38">    }
</span><span style="display:block;width:100%;background-color:#3c3d38">}
</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AlbumDetails</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">Component</span> {
    <span style="color:#a6e22e">render</span>() {
<span style="display:block;width:100%;background-color:#3c3d38">        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">props</span>.<span style="color:#a6e22e">album</span>) <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;Loading album...&#39;</span>;
</span><span style="display:block;width:100%;background-color:#3c3d38">        <span style="color:#66d9ef">return</span> (
</span><span style="display:block;width:100%;background-color:#3c3d38">            &lt;<span style="color:#f92672">Segment</span>&gt;
</span><span style="display:block;width:100%;background-color:#3c3d38">            &lt;<span style="color:#f92672">Header</span> <span style="color:#a6e22e">as</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;h3&#39;</span>&gt;{<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">props</span>.<span style="color:#a6e22e">album</span>.<span style="color:#a6e22e">name</span>}&lt;/<span style="color:#f92672">Header</span>&gt;
</span><span style="display:block;width:100%;background-color:#3c3d38">            &lt;<span style="color:#f92672">S3ImageUpload</span> <span style="color:#a6e22e">albumId</span><span style="color:#f92672">=</span><span style="color:#e6db74">{this.props.album.id}/</span>&gt;        
</span><span style="display:block;width:100%;background-color:#3c3d38">            &lt;<span style="color:#f92672">PhotosList</span> <span style="color:#a6e22e">photos</span><span style="color:#f92672">=</span><span style="color:#e6db74">{this.props.album.photos.items}</span> /&gt;
</span><span style="display:block;width:100%;background-color:#3c3d38">            {
</span><span style="display:block;width:100%;background-color:#3c3d38">                <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">props</span>.<span style="color:#a6e22e">hasMorePhotos</span> <span style="color:#f92672">&amp;&amp;</span> 
</span><span style="display:block;width:100%;background-color:#3c3d38">                &lt;<span style="color:#f92672">Form</span><span style="color:#a6e22e">.Button</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">                <span style="color:#a6e22e">onClick</span><span style="color:#f92672">=</span><span style="color:#e6db74">{this.props.loadMorePhotos}</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">                <span style="color:#a6e22e">icon</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;refresh&#39;</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">                <span style="color:#a6e22e">disabled</span><span style="color:#f92672">=</span><span style="color:#e6db74">{this.props.loadingPhotos}</span>
</span><span style="display:block;width:100%;background-color:#3c3d38">                <span style="color:#a6e22e">content</span><span style="color:#f92672">=</span><span style="color:#e6db74">{this.props.loadingPhotos</span> <span style="color:#960050;background-color:#1e0010">?</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">Loading...</span><span style="color:#960050;background-color:#1e0010">&#39;</span> <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">Load</span> <span style="color:#a6e22e">more</span> <span style="color:#a6e22e">photos</span><span style="color:#960050;background-color:#1e0010">&#39;</span>}
</span><span style="display:block;width:100%;background-color:#3c3d38">                /&gt;
</span><span style="display:block;width:100%;background-color:#3c3d38">            }
</span><span style="display:block;width:100%;background-color:#3c3d38">            &lt;/<span style="color:#f92672">Segment</span>&gt;
</span><span style="display:block;width:100%;background-color:#3c3d38">        )
</span>    }
}


<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AlbumsListLoader</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">Component</span> {
    <span style="color:#a6e22e">onNewAlbum</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">prevQuery</span>, <span style="color:#a6e22e">newData</span>) =&gt; {
        <span style="color:#75715e">// When we get data about a new album, we need to put in into an object 
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// with the same shape as the original query results, but with the new data added as well
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">updatedQuery</span> <span style="color:#f92672">=</span> Object.<span style="color:#a6e22e">assign</span>({}, <span style="color:#a6e22e">prevQuery</span>);
        <span style="color:#a6e22e">updatedQuery</span>.<span style="color:#a6e22e">listAlbums</span>.<span style="color:#a6e22e">items</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">prevQuery</span>.<span style="color:#a6e22e">listAlbums</span>.<span style="color:#a6e22e">items</span>.<span style="color:#a6e22e">concat</span>([<span style="color:#a6e22e">newData</span>.<span style="color:#a6e22e">onCreateAlbum</span>]);
        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">updatedQuery</span>;
    }

    <span style="color:#a6e22e">render</span>() {
        <span style="color:#66d9ef">return</span> (
            &lt;<span style="color:#f92672">Connect</span> 
                <span style="color:#a6e22e">query</span><span style="color:#f92672">=</span><span style="color:#e6db74">{graphqlOperation(ListAlbums)}</span>
                <span style="color:#a6e22e">subscription</span><span style="color:#f92672">=</span><span style="color:#e6db74">{graphqlOperation(SubscribeToNewAlbums)}</span> 
                <span style="color:#a6e22e">onSubscriptionMsg</span><span style="color:#f92672">=</span><span style="color:#e6db74">{this.onNewAlbum}</span>
            &gt;
                {({ <span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">loading</span> }) =&gt; {
                    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">loading</span>) { <span style="color:#66d9ef">return</span> &lt;<span style="color:#f92672">div</span>&gt;<span style="color:#a6e22e">Loading</span>...&lt;/<span style="color:#f92672">div</span>&gt;; }
                    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">listAlbums</span>) <span style="color:#66d9ef">return</span>;

                <span style="color:#66d9ef">return</span> &lt;<span style="color:#f92672">AlbumsList</span> <span style="color:#a6e22e">albums</span><span style="color:#f92672">=</span><span style="color:#e6db74">{data.listAlbums.items}</span> /&gt;;
                }}
            &lt;/<span style="color:#f92672">Connect</span>&gt;
        );
    }
}


<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">App</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">Component</span> {
  <span style="color:#a6e22e">render</span>() {
    <span style="color:#66d9ef">return</span> (
      &lt;<span style="color:#f92672">Router</span>&gt;
        &lt;<span style="color:#f92672">Grid</span> <span style="color:#a6e22e">padded</span>&gt;
          &lt;<span style="color:#f92672">Grid</span><span style="color:#a6e22e">.Column</span>&gt;
            &lt;<span style="color:#f92672">Route</span> <span style="color:#a6e22e">path</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#a6e22e">exact</span> <span style="color:#a6e22e">component</span><span style="color:#f92672">=</span><span style="color:#e6db74">{NewAlbum}/</span>&gt;
            &lt;<span style="color:#f92672">Route</span> <span style="color:#a6e22e">path</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#a6e22e">exact</span> <span style="color:#a6e22e">component</span><span style="color:#f92672">=</span><span style="color:#e6db74">{AlbumsListLoader}/</span>&gt;

            &lt;<span style="color:#f92672">Route</span>
              <span style="color:#a6e22e">path</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/albums/:albumId&#34;</span>
              <span style="color:#a6e22e">render</span><span style="color:#f92672">=</span><span style="color:#e6db74">{</span> <span style="color:#960050;background-color:#1e0010">()</span> <span style="color:#960050;background-color:#1e0010">=</span>&gt; &lt;<span style="color:#f92672">div</span>&gt;&lt;<span style="color:#f92672">NavLink</span> <span style="color:#a6e22e">to</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;/&#39;</span>&gt;<span style="color:#a6e22e">Back</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">Albums</span> <span style="color:#a6e22e">list</span>&lt;/<span style="color:#f92672">NavLink</span>&gt;&lt;/<span style="color:#f92672">div</span>&gt; }
            <span style="color:#960050;background-color:#1e0010">/&gt;</span>
            &lt;<span style="color:#f92672">Route</span>
              <span style="color:#a6e22e">path</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/albums/:albumId&#34;</span>
              <span style="color:#a6e22e">render</span><span style="color:#f92672">=</span><span style="color:#e6db74">{</span> <span style="color:#a6e22e">props </span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&gt;</span> <span style="color:#e6db74">&lt;AlbumDetailsLoader</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">{props.match.params.albumId}/</span>&gt; }
            <span style="color:#960050;background-color:#1e0010">/&gt;</span>
          <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/Grid.Column&gt;</span>
        &lt;/<span style="color:#f92672">Grid</span>&gt;
      &lt;/<span style="color:#f92672">Router</span>&gt;
    );
  }
}

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#a6e22e">withAuthenticator</span>(<span style="color:#a6e22e">App</span>, {<span style="color:#a6e22e">includeGreetings</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>});</code></pre></div>
</div></p>

<h3 id="src-app-js-변경사항">src/App.js 변경사항</h3>

<ul>
<li><p>의존 라이브러리 추가: v4 as uuid from <em>uuid</em></p></li>

<li><p>의존 라이브러리 추가: <em>Divider</em> and <em>Form</em> from <em>semantic-ui-react</em></p></li>

<li><p>의존 라이브러리 추가: <em>Storage</em> from <em>aws-amplify</em></p></li>

<li><p>의존 라이브러리 추가: <em>S3Image</em> from <em>aws-amplify-react</em></p></li>

<li><p>페이징을 제공하기 위한  <em>GetAlbum</em> 쿼리 수정</p></li>

<li><p>새로운 컴포넌트 생성: <em>S3ImageUpload</em> and <em>PhotosList</em></p></li>

<li><p>페이징을 제공하기 위해 <em>AlbumDetailsLoader</em> 수정</p></li>

<li><p><em>AlbumDetails</em> 에 <em>PhotosList</em> 추가</p></li>
</ul>

<h3 id="사진-업로드-하기">사진 업로드 하기</h3>

<p>이 시점에서 봐야 할 것은 별로 없습니다. 업로드 버튼을 클릭하고 파일을 선택한 후, 업로드 버튼으로 다시 바뀌기 전에 <em>&lsquo;Uploading…&rsquo;</em> 으로 바뀌는지 확인해보세요.</p>

<p><div class="notices tip" ><p>AWS 웹 콘솔에서 S3 버킷을 직접 탐색하여 파일이 업로드되고 있는지 확인할 수도 있습니다. 버킷 이름을 찾는 가장 쉬운 방법은 <em>src / aws-exports.js</em> 파일에서  <strong>aws_user_files_s3_bucket</strong> 에 설정된 값을 찾는 것입니다. S3 웹 콘솔에서 bucket을 찾아 <em>public/uploads</em> 하위에 업로드 한 파일들을 찾아봅니다.</p>
</div>
</p>

<div class="notices info" ><p>새로 생성한 <em>S3ImageUpload</em> 컴포넌트는 몇가지 호출 기능이 있습니다. 어플리케이션에서 설정한 S3 버킷에 파일을 업로드 하기 위해 AWS Amplify의 <em>Storage.put</em> 메소드를 사용하는데 이 API 호출할때 몇가지 추가 옵션들을 같이 전달합니다.
  <br/><br/>
  <em>customPrefix: { public: &lsquo;uploads/&rsquo; }</em>  : 자동으로 각 사진들의 미리보기 이미지(thumbnail)를 만들고 싶을 때 전달합니다. S3 버킷에 미리보기 생성 기능을 실행하는 트리거가 추가 되기 때문에, 버킷의 <em>uploads/</em> 경로에 파일이 추가 될 때마다 트리거가 바로 실행됩니다. 새로운 썸네일들이 추가되면 이 역시 버킷에 추가되기 때문에 각 썸네일이 생성될 때 마다 썸네일 생성 함수가 재 실행되는 재귀 트리거 루프가 발생할수 있습니다. 이를 피하기 위해서 키 프리픽스 <em>uploads/</em> 를 추가하여 트리거 실행 범위를 제한합니다.
  Amplify는 공개적으로 액세스 할 수 있어야하는 파일을 특정하기 위해 접두어를 사용한다는 것을 알고 있습니다.이 파일은 Storage.put의 기본 권한 수준입니다.
  <br/><br/>
  어플리케이션을 사용하는 사용자라면 누구든지 모든 파일에 대해 접근 할 수 있도록 (API 수준에서) 하는것이 기본정책이라면 문제가 되지 않을까요? 아니요. 우리는 UUID를 사진의 키로 사용하고 있고 사용자들은 앨범의 UUID를 알고 있는 앨범에 대해서면 사진 목록에 접근할 수 있습니다.
  만약 당신이 Amplify Storage 모듈의 모든 API를 읽었다면(기본 S3 API에 익숙한 경우) 이렇게 물을지도 모르겠네요. &ldquo;잠시만요, 사용자들은 공개된 경로에 있는 모든 목록을 조회할 수 있으니 모든 사진들을 볼수 있겠는데요?&rdquo;
  지금은 당신이맞습니다. 나중에 이를 제한하도록 추가 예방 조치를 취해 처리할 예정입니다. (특정 사용자 이름을 활용하여 버킷 항목 리스트를 조회하지 못하도록 제한함)
  <br/><br/>
  <em>metadata: { albumid: this.props.albumId }</em>  :
  S3 썸네일 트리거 함수가 사진에 대한 정보를 데이터 저장소에 추가 하게 합니다. 썸네일 이미지 작성 작업이 완료되고 사진이 업로드된 앨범이 무엇인지 이 옵션을 통해서 알려줍니다.
  예를 들면, 사진의 키에 앨범에 ID를 접두사(prefix)나 접미사(suffix)로 추가 할 수 있습니다.</p>
</div>



<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


        
            <a class="nav nav-prev" href="https://awskrug.github.io/amplify-photo-gallery-workshop/60_managing_photos/30_adding_storage.html" title="Cloud Storage 추가하기"> <i class="fa fa-chevron-left"></i></a>
        
        
            <a class="nav nav-next" href="https://awskrug.github.io/amplify-photo-gallery-workshop/70_generating_thumbnails.html" title="미리보기 만들기" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
        
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/clipboard.min.js?1558848519"></script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/perfect-scrollbar.min.js?1558848519"></script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/perfect-scrollbar.jquery.min.js?1558848519"></script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/jquery.sticky.js?1558848519"></script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/featherlight.min.js?1558848519"></script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/html5shiv-printshiv.min.js?1558848519"></script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/highlight.pack.js?1558848519"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/modernizr.custom.71422.js?1558848519"></script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/learn.js?1558848519"></script>
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/js/hugo-learn.js?1558848519"></script>

    <link href="https://awskrug.github.io/amplify-photo-gallery-workshop/mermaid/mermaid.css?1558848519" type="text/css" rel="stylesheet" />
    <script src="https://awskrug.github.io/amplify-photo-gallery-workshop/mermaid/mermaid.js?1558848519"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

